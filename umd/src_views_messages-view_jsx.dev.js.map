{"version":3,"file":"src_views_messages-view_jsx.dev.js","mappings":"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","sources":["webpack://tinode-webapp/./src/views/logo-view.jsx","webpack://tinode-webapp/./src/views/messages-view.jsx","webpack://tinode-webapp/./src/widgets/attachment.jsx","webpack://tinode-webapp/./src/widgets/chat-message.jsx","webpack://tinode-webapp/./src/widgets/group-subs.jsx","webpack://tinode-webapp/./src/widgets/invitation.jsx","webpack://tinode-webapp/./src/widgets/meta-message.jsx","webpack://tinode-webapp/./src/widgets/pinned-messages.jsx","webpack://tinode-webapp/./src/widgets/reaction-picker.jsx","webpack://tinode-webapp/./src/widgets/reaction-strip.jsx","webpack://tinode-webapp/./src/widgets/received-marker.jsx","webpack://tinode-webapp/./src/widgets/send-message.jsx"],"sourcesContent":["/* This is just a static page to display when no conversation is selected. */\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport { Tinode } from 'tinode-sdk';\n\nimport { APP_NAME } from '../config.js';\n\nexport default class LogoView extends React.PureComponent {\n  render() {\n    const version = APP_NAME + ' (' + Tinode.getLibrary() + ')';\n    return (\n      <div id=\"dummy-view\">\n        <div>\n          <a href=\"https://github.com/tinode/chat/\">\n            <img id=\"logo\" alt=\"logo\" src=\"img/logo.svg\" />\n            <h2>Tinode Web</h2>\n          </a>\n          <p><FormattedMessage id=\"label_client\" defaultMessage=\"Client:\"\n            description=\"Label for a client version\" /> {version}</p>\n          <p><FormattedMessage id=\"label_server\" defaultMessage=\"Server:\"\n            description=\"Label for a server version\" /> {this.props.serverVersion} ({this.props.serverAddress})</p>\n        </div>\n      </div>\n    );\n  }\n};\n","// Panel with a chat.\n\nimport React, { Suspense } from 'react';\nimport { FormattedMessage, defineMessages, injectIntl } from 'react-intl';\n\nimport { Drafty, Tinode, TheCard } from 'tinode-sdk';\n\nconst CallPanel = React.lazy(_ => import('../widgets/call-panel.jsx'));\nimport ChatMessage from '../widgets/chat-message.jsx';\nimport ContactBadges from '../widgets/contact-badges.jsx';\nconst DocPreview = React.lazy(_ => import('../widgets/doc-preview.jsx'));\nimport ErrorPanel from '../widgets/error-panel.jsx';\nimport GroupSubs from '../widgets/group-subs.jsx';\nconst ImagePreview = React.lazy(_ => import('../widgets/image-preview.jsx'));\nimport Invitation from '../widgets/invitation.jsx';\nimport LetterTile from '../widgets/letter-tile.jsx';\nimport LoadSpinner from '../widgets/load-spinner.jsx';\nimport LogoView from './logo-view.jsx';\nimport MetaMessage from '../widgets/meta-message.jsx';\nimport PinnedMessages from '../widgets/pinned-messages.jsx';\nimport SendMessage from '../widgets/send-message.jsx';\nconst TheCardPreview = React.lazy(_ => import('../widgets/the-card-preview.jsx'));\nconst VideoPreview = React.lazy(_ => import('../widgets/video-preview.jsx'));\n\nimport { DEFAULT_P2P_ACCESS_MODE, EDIT_PREVIEW_LENGTH, IMAGE_PREVIEW_DIM, IMMEDIATE_P2P_SUBSCRIPTION,\n  DRAFTY_FR_MIME_TYPE_LEGACY, KEYPRESS_DELAY, MESSAGES_PAGE, MAX_EXTERN_ATTACHMENT_SIZE, MAX_IMAGE_DIM,\n  MAX_INBAND_ATTACHMENT_SIZE, READ_DELAY, QUOTED_REPLY_LENGTH, VIDEO_PREVIEW_DIM } from '../config.js';\nimport { CALL_STATE_OUTGOING_INITATED, CALL_STATE_IN_PROGRESS } from '../constants.js';\nimport { blobToBase64, fileToBase64, imageScaled, importVCard, makeImageUrl } from '../lib/blob-helpers.js';\nimport HashNavigation from '../lib/navigation.js';\nimport { bytesToHumanSize, relativeDateFormat, shortDateFormat } from '../lib/strformat.js';\n\n// Run timer with this frequency (ms) for checking notification queue.\nconst NOTIFICATION_EXEC_INTERVAL = 300;\n// Scroll distance before [go to latest message] button is shown.\nconst SHOW_GO_TO_LAST_DIST = 100;\n// Sctoll distance from the top when fetching the page of earlier messages is triggered.\nconst FETCH_PAGE_TRIGGER = 40;\n\nconst messages = defineMessages({\n  online_now: {\n    id: 'online_now',\n    defaultMessage: 'online now',\n    description: 'Indicator that the user or topic is currently online',\n  },\n  last_seen: {\n    id: 'last_seen_timestamp',\n    defaultMessage: 'Last seen: {timestamp}',\n    description: 'Label for the timestamp of when the user or topic was last online'\n  },\n  not_found: {\n    id: 'title_not_found',\n    defaultMessage: 'Not found',\n    description: 'Title shown when topic is not found'\n  },\n  channel: {\n    id: 'channel',\n    defaultMessage: 'channel',\n    description: 'Subtitle shown for channels in MessagesView instead of last seen'\n  },\n  file_attachment_too_large: {\n    id: 'file_attachment_too_large',\n    defaultMessage: 'The file size {size} exceeds the {limit} limit.',\n    description: 'Error message when attachment is too large'\n  },\n  invalid_content: {\n    id: 'invalid_content',\n    defaultMessage: 'invalid content',\n    description: 'Shown when the message is unreadable'\n  },\n  editing_message: {\n    id: 'editing_message',\n    defaultMessage: 'Editing',\n    description: 'Title over message editing preview'\n  },\n  drag_file: {\n    id: 'drag_file',\n    defaultMessage: 'Drag file here',\n    description: 'Prompt on the file drag-n-drop overlay banner'\n  },\n  self_topic_name: {\n    id: 'self_topic_name',\n    defaultMessage: 'Saved messages',\n    description: 'Name of self topic for UI'\n  },\n  subscriber_count: {\n    id: 'subscriber_count',\n    defaultMessage: '{count, plural, ' +\n      'one {{count, number} subscriber} ' +\n      'two {{count, number} subscribers} ' +\n      'three {{count, number} subscribers} ' +\n      'few {{count, number} subscribers} ' +\n      'many {{count, number} subscribers} ' +\n      'other {{count, number} subscribers}}',\n    description: 'Count of channel subscribers'\n  },\n  member_count: {\n    id: 'member_count',\n    defaultMessage: '{count, plural, ' +\n      'one {{count, number} member} ' +\n      'two {{count, number} members} ' +\n      'three {{count, number} members} ' +\n      'few {{count, number} members} ' +\n      'many {{count, number} members} ' +\n      'other {{count, number} members}}',\n    description: 'Count of group topic members'\n  },\n  cannot_parse_vcard: {\n    id: 'cannot_parse_vcard',\n    defaultMessage: 'Cannot parse vCard file.',\n    description: 'Error message when vCard file cannot be parsed'\n  }\n});\n\n// Checks if the access permissions are granted but not yet accepted.\nfunction isUnconfirmed(acs) {\n  if (acs) {\n    const ex = acs.getExcessive() || '';\n    return acs.isJoiner('given') && (ex.includes('R') || ex.includes('W'));\n  }\n  return false;\n}\n\nfunction isPeerRestricted(acs) {\n  if (acs) {\n    const ms = acs.getMissing() || '';\n    return acs.isJoiner('want') && (ms.includes('R') || ms.includes('W'));\n  }\n  return false;\n}\n\nfunction shouldPresentCallPanel(callState) {\n  // Show call panel if either:\n  // - call is outgoing (and the client is waiting for the other side to pick up) or,\n  // - call is already in progress.\n  return callState == CALL_STATE_OUTGOING_INITATED || callState == CALL_STATE_IN_PROGRESS;\n}\n\nclass MessagesView extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = MessagesView.getDerivedStateFromProps(props, {});\n\n    this.componentSetup = this.componentSetup.bind(this);\n    this.leave = this.leave.bind(this);\n    this.sendMessage = this.sendMessage.bind(this);\n    this.retrySend = this.retrySend.bind(this);\n    this.sendImageAttachment = this.sendImageAttachment.bind(this);\n    this.sendVideoAttachment = this.sendVideoAttachment.bind(this);\n    this.sendFileAttachment = this.sendFileAttachment.bind(this);\n    this.sendAudioAttachment = this.sendAudioAttachment.bind(this);\n    this.sendTheCardAttachment = this.sendTheCardAttachment.bind(this);\n    this.sendKeyPress = this.sendKeyPress.bind(this);\n    this.subscribe = this.subscribe.bind(this);\n    this.handleScrollReference = this.handleScrollReference.bind(this);\n    this.mountComponentEvents = this.mountComponentEvents.bind(this);\n    this.handleScrollEvent = this.handleScrollEvent.bind(this);\n    this.handleDescChange = this.handleDescChange.bind(this);\n    this.handleSubsUpdated = this.handleSubsUpdated.bind(this);\n    this.handleMessageUpdate = this.handleMessageUpdate.bind(this);\n    this.handleReactUpdate = this.handleReactUpdate.bind(this);\n    this.handleAuxUpdate = this.handleAuxUpdate.bind(this);\n    this.handleAllMessagesReceived = this.handleAllMessagesReceived.bind(this);\n    this.handleInfoReceipt = this.handleInfoReceipt.bind(this);\n    this.handleExpandMedia = this.handleExpandMedia.bind(this);\n    this.handleClosePreview = this.handleClosePreview.bind(this);\n    this.handleCallPanelToggle = this.handleCallPanelToggle.bind(this);\n    this.handleFormResponse = this.handleFormResponse.bind(this);\n    this.handleContextClick = this.handleContextClick.bind(this);\n    this.handleShowMessageContextMenu = this.handleShowMessageContextMenu.bind(this);\n    this.handleNewChatAcceptance = this.handleNewChatAcceptance.bind(this);\n    this.handleEnablePeer = this.handleEnablePeer.bind(this);\n    this.handleAttachFile = this.handleAttachFile.bind(this);\n    this.handleAttachImageOrVideo = this.handleAttachImageOrVideo.bind(this);\n    this.handleCancelUpload = this.handleCancelUpload.bind(this);\n    this.postReadNotification = this.postReadNotification.bind(this);\n    this.clearNotificationQueue = this.clearNotificationQueue.bind(this);\n    this.goToLatestMessage = this.goToLatestMessage.bind(this);\n    this.handleFileDrop = this.handleFileDrop.bind(this);\n\n    this.handlePickReply = this.handlePickReply.bind(this);\n    this.handleEditMessage = this.handleEditMessage.bind(this);\n    this.handleCancelReply = this.handleCancelReply.bind(this);\n    this.handleQuoteClick = this.handleQuoteClick.bind(this);\n    this.handleUnpinMessage = this.handleUnpinMessage.bind(this);\n    this.handleCallHangup = this.handleCallHangup.bind(this);\n\n    this.isDragEnabled = this.isDragEnabled.bind(this);\n\n    this.handleReact = this.handleReact.bind(this);\n    this.handleToggleReactionPicker = this.handleToggleReactionPicker.bind(this);\n\n    this.handleDragStart = this.handleDragStart.bind(this);\n    this.handleDragIn = this.handleDragIn.bind(this);\n    this.handleDragOut = this.handleDragOut.bind(this);\n    this.handleDrag = this.handleDrag.bind(this);\n    this.handleDrop = this.handleDrop.bind(this);\n\n    this.chatMessageRefs = [];\n    this.getOrCreateMessageRef = this.getOrCreateMessageRef.bind(this);\n    this.getVisibleMessageRange = this.getVisibleMessageRange.bind(this);\n\n    // Keeps track of the drag event.\n    // Need a counter b/c the browser's 'drag' events may fire multiple times\n    // when the user takes the mouse pointer over the container:\n    // for the component itself and for all nested/child elements.\n    this.dragCounter = 0;\n    this.componentRef = null;\n\n    this.readNotificationQueue = [];\n    this.readNotificationTimer = null;\n\n    this.keyPressTimer = null;\n  }\n\n  getOrCreateMessageRef(seqId) {\n    if (this.chatMessageRefs[seqId]) {\n      return this.chatMessageRefs[seqId];\n    }\n    const ref = React.createRef();\n    this.chatMessageRefs[seqId] = ref;\n    return ref;\n  }\n\n  getVisibleMessageRange(holderRect) {\n    let min = Number.MAX_SAFE_INTEGER, max = -1;\n    let visibilityStatus = false;\n    this.chatMessageRefs.every((ref, seq) => {\n      if (ref.current) {\n        const { top, bottom, height } = ref.current.getBoundingClientRect();\n        const visible = top <= holderRect.top ? holderRect.top - top <= height : bottom - holderRect.bottom <= height;\n        if (visible) {\n          visibilityStatus = true;\n          min = Math.min(min, seq);\n          max = Math.max(max, seq);\n        } else if (visibilityStatus) {\n          // The remaining elements are no longer visible, no need to iterate them.\n          return false;\n        }\n      }\n      return true;\n    });\n\n    return max >= min ? {min: min, max: max} : {min: 0, max: 0};\n  }\n\n  componentDidMount() {\n    if (this.messagesScroller) {\n      this.messagesScroller.addEventListener('scroll', this.handleScrollEvent);\n    }\n\n    // Drag and drop events\n    this.mountComponentEvents(this.componentRef);\n\n    this.componentSetup({}, {});\n  }\n\n  componentWillUnmount() {\n    if (this.messagesScroller) {\n      this.messagesScroller.removeEventListener('scroll', this.handleScrollEvent);\n    }\n\n    // Flush all notifications.\n    this.clearNotificationQueue();\n\n    // Drag and drop events\n    if (this.componentRef) {\n      this.componentRef.removeEventListener('dragstart', this.handleDragStart);\n      this.componentRef.removeEventListener('dragenter', this.handleDragIn);\n      this.componentRef.removeEventListener('dragleave', this.handleDragOut);\n      this.componentRef.removeEventListener('dragover', this.handleDrag);\n      this.componentRef.removeEventListener('drop', this.handleDrop);\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    // Scroll last message into view on component update e.g. on message received\n    // or vertical shrinking.\n    if (this.messagesScroller &&\n      (prevState.topic != this.state.topic || prevState.maxSeqId != this.state.maxSeqId ||\n        prevState.minSeqId != this.state.minSeqId)) {\n      // New message.\n      if (this.state.scrollPosition < SHOW_GO_TO_LAST_DIST) {\n        this.messagesScroller.scrollTop = this.messagesScroller.scrollHeight -\n          this.state.scrollPosition - this.messagesScroller.offsetHeight;\n      }\n    }\n\n    if (!this.props.applicationVisible) {\n      // If application is not visible, flush all unsent 'read' notifications.\n      this.clearNotificationQueue();\n    } else {\n      // Otherwise assume there are unread messages.\n      this.postReadNotification(0);\n    }\n\n    this.componentSetup(prevProps, prevState);\n  }\n\n  componentSetup(prevProps, prevState) {\n    const topic = this.props.tinode ? this.props.tinode.getTopic(this.state.topic) : undefined;\n    if (this.state.topic != prevState.topic) {\n      if (prevState.topic && !Tinode.isNewGroupTopicName(prevState.topic)) {\n        this.leave(prevState.topic);\n        if (prevState.rtcPanel) {\n          this.handleCallHangup(prevState.topic, prevProps.callSeq);\n        }\n      }\n\n      if (topic) {\n        topic.onData = this.handleMessageUpdate;\n        topic.onAllMessagesReceived = this.handleAllMessagesReceived;\n        topic.onInfo = this.handleInfoReceipt;\n        topic.onMetaDesc = this.handleDescChange;\n        topic.onSubsUpdated = this.handleSubsUpdated;\n        topic.onPres = this.handleSubsUpdated;\n        topic.onAuxUpdated = this.handleAuxUpdate;\n        topic.onReact = this.handleReactUpdate;\n      }\n    }\n\n    if (topic) {\n      if ((this.state.topic != prevState.topic) || (this.props.myUserId && !prevProps.myUserId)) {\n        // Don't immediately subscribe to a new p2p topic, wait for the first message.\n        const newTopic = (this.props.newTopicParams && this.props.newTopicParams._topicName == this.props.topic);\n        if (topic.isP2PType() && newTopic && !IMMEDIATE_P2P_SUBSCRIPTION) {\n          topic.getMeta(topic.startMetaQuery().withDesc().build());\n        } else if (this.props.myUserId) {\n          this.subscribe(topic);\n        }\n      } else if (topic.isSubscribed() && this.state.isReader && !prevState.isReader) {\n        // If reader status has changed and data became available.\n        topic.getMeta(topic.startMetaQuery().withLaterData().build());\n      }\n    }\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    let nextState = {};\n    if (!nextProps.topic) {\n      // Default state: no topic.\n      nextState = {\n        minSeqId: -1,\n        maxSeqId: -1,\n        latestClearId: -1,\n        onlineSubs: [],\n        topic: null,\n        title: '',\n        avatar: null,\n        isVerified: false,\n        isStaff: false,\n        isDangerous: false,\n        deleted: false,\n        docPreview: null,\n        imagePreview: null,\n        imagePostview: null,\n        videoPreview: null,\n        videoPostview: null,\n        rtcPanel: null,\n        minimizedCallPanel: false,\n        typingIndicator: false,\n        scrollPosition: 0,\n        fetchingMessages: false,\n        peerMessagingDisabled: false,\n        channel: false,\n        reply: null,\n        contentToEdit: null,\n        showGoToLastButton: false,\n        dragging: false,\n        pins: [],\n        pinsLoaded: false,\n        selectedPin: 0,\n        subsVersion: 0,\n        reactionPickerShownFor: -1,\n        reactionList: null,\n        maxReactions: 0,\n      };\n    } else if (nextProps.topic != prevState.topic) {\n      nextState = {\n        topic: nextProps.topic,\n        docPreview: null,\n        imagePreview: null,\n        imagePostview: null,\n        videoPreview: null,\n        videoPostview: null,\n        rtcPanel: null,\n        minimizedCallPanel: false,\n        typingIndicator: false,\n        scrollPosition: 0,\n        fetchingMessages: false,\n        showGoToLastButton: false,\n        contentToEdit: null,\n        dragging: false,\n        selectedPin: 0,\n        reactionPickerShownFor: -1,\n      };\n\n      if (nextProps.forwardMessage) {\n        if (nextProps.forwardMessage.content) {\n          const content = nextProps.forwardMessage.content;\n          const size = content?.length || (content?.size || 0);\n          nextState.docPreview = {\n            object: content,\n            type: nextProps.forwardMessage.type,\n            size: size\n          };\n        } else {\n          // We are forwarding a message. Show preview.\n          nextState.reply = {\n            content: nextProps.forwardMessage.preview,\n            seq: null\n          };\n        }\n      } else {\n        nextState.reply = null;\n      }\n\n      const topic = nextProps.tinode.getTopic(nextProps.topic);\n      if (topic) {\n        // Topic exists.\n        nextState.deleted = topic._deleted;\n\n        const subs = [];\n        if (nextProps.connected) {\n          topic.subscribers((sub) => {\n            if (sub.online && sub.user != nextProps.myUserId) {\n              subs.push(sub);\n            }\n          });\n        }\n\n        Object.assign(nextState, {\n          onlineSubs: subs\n        });\n\n        if (topic.isSelfType()) {\n          Object.assign(nextState, {\n            title: nextProps.intl.formatMessage(messages.self_topic_name),\n            avatar: true\n          });\n        } else if (topic.public) {\n          Object.assign(nextState, {\n            title: topic.public.fn,\n            avatar: makeImageUrl(topic.public.photo)\n          });\n        } else {\n          Object.assign(nextState, {\n            title: '',\n            avatar: null\n          });\n        }\n\n        const peer = topic.p2pPeerDesc();\n        if (peer) {\n          Object.assign(nextState, {\n            peerMessagingDisabled: isPeerRestricted(peer.acs)\n          });\n        } else if (prevState.peerMessagingDisabled) {\n          Object.assign(nextState, {\n            peerMessagingDisabled: false\n          });\n        }\n        Object.assign(nextState, {\n          minSeqId: topic.minMsgSeq(),\n          maxSeqId: topic.maxMsgSeq(),\n          latestClearId: topic.maxClearId(),\n          channel: topic.isChannelType(),\n          pins: (topic.aux('pins') || []).slice(),\n          pinsLoaded: false\n        });\n\n        if (nextProps.callTopic == topic.name && shouldPresentCallPanel(nextProps.callState)) {\n          nextState.rtcPanel = nextProps.callTopic;\n        }\n\n        nextState.reactionList = topic.reactions();\n        nextState.maxReactions = topic.maxReactions();\n      } else {\n        // Invalid topic.\n        Object.assign(nextState, {\n          minSeqId: -1,\n          maxSeqId: -1,\n          latestClearId: -1,\n          onlineSubs: [],\n          title: '',\n          avatar: null,\n          peerMessagingDisabled: false,\n          channel: false,\n          pins: [],\n          pinsLoaded: false\n        });\n      }\n    } else {\n      // We are still in same topic. Show the call panel if necessary.\n      if (nextProps.callTopic == prevState.topic && !prevState.rtcPanel &&\n          shouldPresentCallPanel(nextProps.callState)) {\n        nextState.rtcPanel = nextProps.callTopic;\n      }\n    }\n\n    if (nextProps.acs) {\n      if (nextProps.acs.isWriter() != prevState.isWriter) {\n        nextState.isWriter = !prevState.isWriter;\n      }\n      if (nextProps.acs.isReader() != prevState.isReader) {\n        nextState.isReader = !prevState.isReader;\n      }\n      if (nextProps.acs.isAdmin() != prevState.isAdmin) {\n        nextState.isAdmin = !prevState.isAdmin;\n      }\n      if (!nextProps.acs.isReader('given') != prevState.readingBlocked) {\n        nextState.readingBlocked = !prevState.readingBlocked;\n      }\n      if (nextProps.acs.isSharer() != prevState.isSharer) {\n        nextState.isSharer = !prevState.isSharer;\n      }\n    } else {\n      if (prevState.isWriter) {\n        nextState.isWriter = false;\n      }\n      if (prevState.isReader) {\n        nextState.isReader = false;\n      }\n      if (prevState.isAdmin) {\n        nextState.isAdmin = false;\n      }\n      if (!prevState.readingBlocked) {\n        prevState.readingBlocked = true;\n      }\n      if (prevState.isSharer) {\n        nextState.isSharer = false;\n      }\n    }\n\n    if (isUnconfirmed(nextProps.acs) == !prevState.unconformed) {\n      nextState.unconfirmed = !prevState.unconformed;\n    }\n\n    // Clear subscribers online when there is no connection.\n    if (!nextProps.connected && prevState.onlineSubs && prevState.onlineSubs.length > 0) {\n      nextState.onlineSubs = [];\n    }\n\n    return nextState;\n  }\n\n  subscribe(topic) {\n    if (topic.isSubscribed() || !this.props.ready) {\n      return;\n    }\n\n    // Is this a new topic?\n    const newTopic = (this.props.newTopicParams && this.props.newTopicParams._topicName == this.props.topic);\n    // Don't request the tags. They are useless unless the user\n    // is the owner and is editing the topic.\n    let getQuery = topic.startMetaQuery().withLaterDesc().withLaterSub().withAux();\n    if (this.state.isReader || newTopic) {\n      // Reading is either permitted or we don't know because it's a new topic. Ask for messages.\n      getQuery = getQuery.withLaterData(MESSAGES_PAGE);\n      if (this.state.isReader) {\n        getQuery = getQuery.withLaterDel();\n      }\n      // And show \"loading\" spinner.\n      this.setState({ fetchingMessages: true });\n    }\n\n    const setQuery = newTopic ? this.props.newTopicParams : undefined;\n    topic.subscribe(getQuery.build(), setQuery)\n      .then(ctrl => {\n        if (ctrl.code == 303) {\n          // Redirect to another topic requested.\n          HashNavigation.navigateTo(HashNavigation.setUrlTopic('', ctrl.params.topic));\n          return;\n        }\n        if (this.state.topic != ctrl.topic) {\n          this.setState({topic: ctrl.topic});\n        }\n        if (this.state.deleted) {\n          this.setState({deleted: false});\n        }\n        this.props.onNewTopicCreated(this.props.topic, ctrl.topic);\n        // If there are unsent messages (except hard-failed and video call messages),\n        // try sending them now. Hard-failed and unsent video call messages will be dropped.\n        let discard = [];\n        topic.queuedMessages(pub => {\n          if (pub._sending) {\n            return;\n          }\n          if (pub._fatal || (pub.head && pub.head.webrtc)) {\n            // Filter out unsent failed & video call messages.\n            discard.push(pub.seq);\n            return;\n          }\n          if (topic.isSubscribed()) {\n            this.retrySend(pub);\n          }\n        });\n        if (discard.length > 0) {\n          topic.delMessagesList(discard, true);\n        }\n      })\n      .catch(err => {\n        console.error(\"Failed subscription to\", this.state.topic, err);\n        this.props.onError(err.message, 'err');\n        const blankState = MessagesView.getDerivedStateFromProps({}, {});\n        blankState.title = this.props.intl.formatMessage(messages.not_found);\n        this.setState(blankState);\n      });\n  }\n\n  leave(oldTopicName) {\n    if (!oldTopicName || !this.props.tinode.isTopicCached(oldTopicName)) {\n      return;\n    }\n\n    const oldTopic = this.props.tinode.getTopic(oldTopicName);\n    if (oldTopic && oldTopic.isSubscribed()) {\n      oldTopic.leave(false)\n        .catch(_ => { /* do nothing here */ })\n        .finally(_ => {\n          // We don't care if the request succeeded or failed.\n          // The topic is dead regardless.\n          this.setState({fetchingMessages: false});\n          oldTopic.onData = undefined;\n          oldTopic.onAllMessagesReceived = undefined;\n          oldTopic.onInfo = undefined;\n          oldTopic.onMetaDesc = undefined;\n          oldTopic.onSubsUpdated = undefined;\n          oldTopic.onPres = undefined;\n          oldTopic.onAuxUpdated = undefined;\n        });\n    }\n  }\n\n  // Don't use React.createRef as the ref.current is not available in componentDidMount in this component.\n  handleScrollReference(node) {\n    if (node) {\n      node.addEventListener('scroll', this.handleScrollEvent);\n      this.messagesScroller = node;\n      this.messagesScroller.scrollTop = this.messagesScroller.scrollHeight -\n        this.state.scrollPosition - this.messagesScroller.offsetHeight;\n    }\n  }\n\n  // Get older messages and show/hide [go to latest message] button.\n  handleScrollEvent(event) {\n    const pos = event.target.scrollHeight - event.target.scrollTop - event.target.offsetHeight;\n    this.setState({\n      scrollPosition: pos,\n      // Show [go to latest message] if far enough from bottom and scrolling down.\n      showGoToLastButton: (pos > SHOW_GO_TO_LAST_DIST) && (pos < this.state.scrollPosition),\n    });\n\n    if (this.state.fetchingMessages || this.processingScrollEvent) {\n      return;\n    }\n\n    if (event.target.scrollTop <= FETCH_PAGE_TRIGGER) {\n      const topic = this.props.tinode.getTopic(this.state.topic);\n      if (topic && topic.isSubscribed()) {\n        this.processingScrollEvent = true;\n        const {min, max} = this.getVisibleMessageRange(event.target.getBoundingClientRect());\n        const gaps = topic.msgHasMoreMessages(min, max, false);\n        if (gaps.length > 0) {\n          this.setState({fetchingMessages: true}, _ => {\n            topic.getMessagesPage(MESSAGES_PAGE, gaps, min, max)\n              .catch(err => this.props.onError(err.message, 'err'))\n              .finally(_ => this.setState({fetchingMessages: false}));\n            });\n        }\n      }\n    }\n    this.processingScrollEvent = false;\n  }\n\n  /* Mount drag and drop events */\n  mountComponentEvents(componentRef) {\n    if (componentRef) {\n      componentRef.addEventListener('dragstart', this.handleDragStart);\n      componentRef.addEventListener('dragenter', this.handleDragIn);\n      componentRef.addEventListener('dragleave', this.handleDragOut);\n      componentRef.addEventListener('dragover', this.handleDrag);\n      componentRef.addEventListener('drop', this.handleDrop);\n      this.componentRef = componentRef;\n    }\n  }\n\n  goToLatestMessage() {\n    this.setState({scrollPosition: 0});\n    if (this.messagesScroller) {\n      this.messagesScroller.scrollTop = this.messagesScroller.scrollHeight - this.messagesScroller.offsetHeight;\n    }\n  }\n\n  handleDescChange(desc) {\n    if (Tinode.isSelfTopicName(this.props.topic)) {\n      this.setState({\n        title: this.props.intl.formatMessage(messages.self_topic_name),\n        avatar: true\n      });\n    } else if (desc.public) {\n      this.setState({\n        title: desc.public.fn,\n        avatar: makeImageUrl(desc.public.photo)\n      });\n    } else {\n      this.setState({\n        title: '',\n        avatar: null\n      });\n    }\n\n    if (desc.acs) {\n      this.setState({\n        isWriter: desc.acs.isWriter(),\n        isReader: desc.acs.isReader(),\n        isAdmin: desc.acs.isAdmin(),\n        readingBlocked: !desc.acs.isReader('given'),\n        unconfirmed: isUnconfirmed(desc.acs),\n      });\n    }\n  }\n\n  postReadNotification(seq) {\n    // Ignore notifications if the app is invisible or topic is not yet available.\n    if (!this.props.applicationVisible || !this.state.topic) {\n      return;\n    }\n\n    // Set up the timer if it's not running already.\n    if (!this.readNotificationTimer) {\n      this.readNotificationTimer = setInterval(_ => {\n        const topic = this.props.tinode.getTopic(this.state.topic);\n        if (topic) {\n          topic.markReactionsSeen();\n        }\n        if (this.readNotificationQueue.length == 0) {\n          // Shut down the timer if the queue is empty.\n          clearInterval(this.readNotificationTimer);\n          this.readNotificationTimer = null;\n          return;\n        }\n\n        let seq = -1;\n        while (this.readNotificationQueue.length > 0) {\n          const n = this.readNotificationQueue[0];\n          if (n.topicName != this.state.topic) {\n            // Topic has changed. Drop the notification.\n            this.readNotificationQueue.shift();\n            continue;\n          }\n\n          const now = new Date();\n          if (n.sendAt <= now) {\n            // Remove expired notification from queue.\n            this.readNotificationQueue.shift();\n            if (n.seq == 0 || Tinode.isServerAssignedSeq(n.seq)) {\n              seq = Math.max(seq, n.seq);\n            }\n          } else {\n            break;\n          }\n        }\n\n        // Send only one notification for the whole batch of messages.\n        if (seq >= 0) {\n          try {\n            topic.noteRead(seq);\n          } catch (err) {\n            console.error(\"Failed to send read notification\", err);\n          }\n        }\n      }, NOTIFICATION_EXEC_INTERVAL);\n    }\n\n    const now = new Date();\n    this.readNotificationQueue.push({\n      topicName: this.state.topic,\n      seq: seq,\n      sendAt: now.setMilliseconds(now.getMilliseconds() + READ_DELAY)\n    });\n  }\n\n  // Clear notification queue and timer.\n  clearNotificationQueue() {\n    this.readNotificationQueue = [];\n    if (this.readNotificationTimer) {\n      clearInterval(this.readNotificationTimer);\n      this.readNotificationTimer = null;\n    }\n  }\n\n  handleSubsUpdated() {\n    if (this.state.topic) {\n      const subs = [];\n      const topic = this.props.tinode.getTopic(this.state.topic);\n      topic.subscribers(sub => {\n        if (sub.online && sub.user != this.props.myUserId) {\n          subs.push(sub);\n        }\n      });\n      const newState = {onlineSubs: subs, subsVersion: this.state.subsVersion + 1};\n      const peer = topic.p2pPeerDesc();\n      if (peer) {\n        Object.assign(newState, {\n          peerMessagingDisabled: isPeerRestricted(peer.acs)\n        });\n      } else if (this.state.peerMessagingDisabled) {\n        Object.assign(newState, {\n          peerMessagingDisabled: false\n        });\n      }\n      this.setState(newState);\n    }\n  }\n\n  // The 'msg' could be false-ish if some message ranges were deleted.\n  handleMessageUpdate(msg) {\n    if (!this.state.topic) {\n      return;\n    }\n    const topic = this.props.tinode.getTopic(this.state.topic);\n    if (!msg) {\n      // msg could be null if one or more messages were deleted.\n      // Updating state to force redraw.\n      this.setState({latestClearId: topic.maxClearId()});\n      return;\n    }\n\n    clearTimeout(this.keyPressTimer)\n    this.setState({maxSeqId: topic.maxMsgSeq(), minSeqId: topic.minMsgSeq(), typingIndicator: false}, _ => {\n      // Scroll to the bottom if the message is added to the end of the message\n      // list if already at the bottom, otherwise show [go to latest] button.\n      // Implemented as a callback to be sure the scroll height has been updated.\n      if (topic.isNewMessage(msg.seq)) {\n        if (this.state.scrollPosition > SHOW_GO_TO_LAST_DIST) {\n          this.setState({showGoToLastButton: true});\n        } else {\n          this.goToLatestMessage();\n        }\n      } else {\n        if (this.messagesScroller) {\n          this.messagesScroller.scrollTop = this.messagesScroller.scrollHeight - this.state.scrollPosition -\n            this.messagesScroller.offsetHeight;\n        }\n      }\n    });\n\n    // Aknowledge messages except own messages. They are\n    // automatically assumed to be read and recived.\n    const status = topic.msgStatus(msg, true);\n    if (status >= Tinode.MESSAGE_STATUS_SENT && msg.from != this.props.myUserId) {\n      this.postReadNotification(msg.seq);\n    }\n  }\n\n  handleReactUpdate(seqIds) {\n    if (!this.state.topic) {\n      return;\n    }\n    this.forceUpdate();\n  }\n\n\n  // Send or remove a reaction on a message.\n  handleReact(seq, emo) {\n    const topic = this.props.tinode.getTopic(this.state.topic);\n    topic.react(seq, emo);\n    this.setState({\n      reactionPickerShownFor: -1\n    });\n  }\n\n  handleToggleReactionPicker(seqId) {\n    this.setState({\n      reactionPickerShownFor: (seqId == -1 || this.state.reactionPickerShownFor == seqId) ? -1 : seqId\n    });\n  }\n\n  handleAllMessagesReceived(count) {\n    this.setState({fetchingMessages: false});\n    if (!count) {\n      // All messages received. Nothing left to receive.\n      const topic = this.props.tinode.getTopic(this.state.topic);\n      if (topic) {\n        // Send read notification for the absolute last message.\n        this.postReadNotification(topic.seq);\n      }\n      return;\n    }\n\n    // Load pinned message too (if any);\n    if (!this.state.pinsLoaded) {\n      // This needs to be guarded to avoid an infinite loop.\n      // The loop may happen if some pinned messages are deleted.\n      const topic = this.props.tinode.getTopic(this.state.topic);\n      this.setState({pinsLoaded: true}, _ => {\n        topic.getPinnedMessages();\n      });\n    } else {\n      this.setState({pinsLoaded: false});\n    }\n  }\n\n  handleAuxUpdate(aux) {\n    const pins = (aux['pins'] || []).slice();\n    let selectedPin = this.state.selectedPin;\n    if (pins.length > this.state.pins.length) {\n      // New pins added, show the latest.\n      selectedPin = 0;\n    } else if (selectedPin >= pins.length) {\n      selectedPin =  Math.max(0, pins.length - 1);\n    }\n    this.setState({pins: pins, selectedPin: selectedPin});\n  }\n\n  handleInfoReceipt(info) {\n    switch (info.what) {\n      case 'kp': {\n        clearTimeout(this.keyPressTimer);\n        this.keyPressTimer = setTimeout(_ => this.setState({typingIndicator: false}), KEYPRESS_DELAY + 1000);\n        if (!this.state.typingIndicator) {\n          this.setState({typingIndicator: true});\n        }\n        break;\n      }\n      case 'read':\n      case 'recv':\n        // Redraw due to changed recv/read status.\n        this.forceUpdate();\n        break;\n      default:\n        console.info(\"Other change in topic: \", info.what);\n    }\n  }\n\n  handleExpandMedia(content) {\n    if (!content) {\n      return;\n    }\n\n    if (content.video) {\n      this.setState({videoPostview: content});\n    } else {\n      this.setState({imagePostview: content});\n    }\n  }\n\n  handleClosePreview() {\n    if (this.state.imagePreview && this.state.imagePreview.url) {\n      URL.revokeObjectURL(this.state.imagePreview.url);\n    }\n    if (this.state.videoPreview && this.state.videoPreview.url) {\n      URL.revokeObjectURL(this.state.videoPreview.url);\n    }\n    this.setState({\n      imagePostview: null,\n      imagePreview: null,\n      docPreview: null,\n      videoPreview: null,\n      videoPostview: null,\n    });\n    this.props.onCancelForwardMessage();\n  }\n\n  handleFormResponse(action, text, data) {\n    if (action == 'pub') {\n      this.sendMessage(Drafty.attachJSON(Drafty.parse(text), data));\n    } else if (action == 'url') {\n      const url = new URL(data.ref);\n      const params = url.searchParams;\n      for (let key in data.resp) {\n        if (data.resp.hasOwnProperty(key)) {\n          params.set(key, data.resp[key]);\n        }\n      }\n      ['name', 'seq'].forEach(key => {\n        if (data[key]) {\n          params.set(key, data[key]);\n        }\n      });\n      params.set('uid', this.props.myUserId);\n      params.set('topic', this.state.topic);\n      url.search = params;\n      window.open(url, '_blank');\n    } else {\n      console.info(\"Unknown action in form\", action);\n    }\n  }\n\n  handleContextClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.showContextMenu({ topicName: this.state.topic, y: e.pageY, x: e.pageX });\n  }\n\n  handleShowMessageContextMenu(params, messageSpecificMenuItems) {\n    if (params.userFrom == 'chan') {\n      params.userFrom = this.state.topic;\n      params.userName = this.state.title;\n    }\n    params.topicName = this.state.topic;\n    const menuItems = messageSpecificMenuItems || [];\n    const topic = this.props.tinode.getTopic(params.topicName);\n    if (topic) {\n      // Self -> (1) always hard-delete with [Delete] title.\n      // P2P -> (1) hard-delete if allowed and not too old, (2) always soft-delete.\n      // Group -> (1) hard-delete if allowed and not too old or owner, (2) always soft-delete.\n      if (topic.isSelfType()) {\n        // Hard-delete with plain [Delete] title.\n        menuItems.push('message_delete_generic');\n      } else {\n        if (!topic.isChannelType()) {\n          // P2P or normal group: always allow to soft-delete.\n          menuItems.push('message_delete');\n        }\n\n        const acs = topic.getAccessMode();\n        if (acs && acs.isDeleter()) {\n          // Owner can always hard-delete regardless of age.\n          let canDelete = acs.isOwner();\n          if (!canDelete) {\n            // Not owner: check message age if configured on the server.\n            const maxDelAge = this.props.tinode.getServerParam(Tinode.MSG_DELETE_AGE, 0) | 0;\n            // Make sure the message is not too old. This check is here just to make the UI\n            // more user-friendly. The server will enforce the limit regardless of this.\n            canDelete = maxDelAge == 0 || (maxDelAge > 0 && params.timestamp ?\n              params.timestamp.getTime() > (new Date().getTime() - maxDelAge * 1000) : false);\n          }\n          if (canDelete) {\n            // [Delete for All] title.\n            menuItems.push('message_delete_hard');\n          }\n        }\n      }\n    }\n    this.props.showContextMenu(params, menuItems);\n  }\n\n  handleNewChatAcceptance(action) {\n    this.props.onNewChat(this.state.topic, action);\n  }\n\n  handleEnablePeer(e) {\n    e.preventDefault();\n    this.props.onChangePermissions(this.state.topic, DEFAULT_P2P_ACCESS_MODE, this.state.topic);\n  }\n\n  sendKeyPress(audio) {\n    const topic = this.props.tinode.getTopic(this.state.topic);\n    if (topic.isSubscribed()) {\n      if (audio) {\n        topic.noteRecording(true);\n      } else {\n        topic.noteKeyPress();\n      }\n    }\n  }\n\n  // sendMessage sends the message with an optional subscription to topic first.\n  sendMessage(msg, uploadCompletionPromise, uploader) {\n    let head;\n    if (!msg && this.props.forwardMessage) {\n      // We are forwarding a message.\n      msg = this.props.forwardMessage.msg;\n      head = this.props.forwardMessage.head;\n      this.handleCancelReply();\n    } else if (this.state.reply) {\n      if (this.state.reply.editing) {\n        if (msg == this.state.contentToEdit) {\n          // Message unchanged.\n          this.handleCancelReply();\n          return;\n        }\n        // Editing an existing message.\n        head = {replace: ':' + this.state.reply.seq};\n      } else if (this.state.reply.content) {\n        // Replying to a message in this topic.\n        // Turn it into Drafty so we can make a quoted Drafty object later.\n        head = {reply: '' + this.state.reply.seq};\n        if (typeof msg == 'string') {\n          msg = Drafty.parse(msg);\n        }\n        msg = Drafty.append(Drafty.sanitizeEntities(this.state.reply.content), msg);\n      }\n      this.handleCancelReply();\n    }\n    this.props.sendMessage(msg, uploadCompletionPromise, uploader, head);\n  }\n\n  // Retry sending a message.\n  retrySend(pub) {\n    this.props.sendMessage(pub.content, undefined, undefined, pub.head)\n      .then(_ => {\n        // All good. Remove the original message draft from the cache.\n        const topic = this.props.tinode.getTopic(this.state.topic);\n        topic.delMessagesList([pub.seq], true);\n      });\n  }\n\n  // sendFileAttachment sends the file as Drafty message:\n  // - if file is too large, upload it and send a s link.\n  // - if file is small enough, just send it in-band.\n  sendFileAttachment(file) {\n    // Server-provided limit reduced for base64 encoding and overhead.\n    const maxInbandAttachmentSize = (this.props.tinode.getServerParam('maxMessageSize',\n      MAX_INBAND_ATTACHMENT_SIZE) * 0.75 - 1024) | 0;\n\n    if (TheCard.isFileSupported(file.type, file.name) || file.type == TheCard.contentType) {\n      // This is a vCard file, try to convert and send as TheCard.\n      if (this.sendTheCardAttachment(file, maxInbandAttachmentSize)) {\n        // Successfully sent as TheCard.\n        return;\n      }\n      // Sending as TheCard failed, fall through to sending as generic file attachment.\n    }\n\n    // If the attachment is a JSON file, then use 'application/octet-stream' instead of 'application/json'.\n    // This is a temporary workaround for the collision with the 'application/json' MIME type of form responses.\n    // Remove this code in 2026 or so.\n    const jsonMimeConverter = (fileType) => fileType === DRAFTY_FR_MIME_TYPE_LEGACY ? 'application/octet-stream' : fileType;\n\n    if (file.size > maxInbandAttachmentSize) {\n      // Too large to send inband - uploading out of band and sending as a link.\n      const uploader = this.props.tinode.getLargeFileHelper();\n      if (!uploader) {\n        this.props.onError(this.props.intl.formatMessage(messages.cannot_initiate_upload));\n        return;\n      }\n      const uploadCompletionPromise = uploader.upload(file);\n      const msg = Drafty.attachFile(null, {\n        mime: jsonMimeConverter(file.type),\n        filename: file.name,\n        size: file.size,\n        urlPromise: uploadCompletionPromise\n      });\n      // Pass data and the uploader to the TinodeWeb.\n      this.sendMessage(msg, uploadCompletionPromise, uploader);\n    } else {\n      // Small enough to send inband.\n      fileToBase64(file)\n        .then(b64 => this.sendMessage(Drafty.attachFile(null, {\n          mime: jsonMimeConverter(b64.mime),\n          data: b64.bits,\n          filename: b64.name,\n          size: file.size\n        })))\n        .catch(err => this.props.onError(err.message, 'err'));\n    }\n  }\n\n  // Convert attached vCard to TheCard and send.\n  sendTheCardAttachment(file, maxInbandAttachmentSize) {\n    if (file.size > maxInbandAttachmentSize) {\n      // Cannot convert to TheCard, send as a generic file attachment instead.\n      return false;\n    }\n\n    if (file.type == TheCard.contentType) {\n      // Already TheCard, no need to convert.\n      this.sendMessage(Drafty.appendTheCard(null, file.object));\n      return true;\n    }\n\n    importVCard(file)\n      .then(card => {\n        this.sendMessage(Drafty.appendTheCard(null, card));\n      })\n      .catch(err => {\n        this.props.onError(this.props.intl.formatMessage(messages.cannot_parse_vcard, {error: err.message}), 'err');\n      });\n    return true;\n  }\n\n  // handleAttachFile method is called when [Attach file] button is clicked: launch attachment preview.\n  handleAttachFile(file) {\n    const maxExternAttachmentSize = this.props.tinode.getServerParam('maxFileUploadSize', MAX_EXTERN_ATTACHMENT_SIZE);\n\n    if (file.size > maxExternAttachmentSize) {\n      // Too large.\n      this.props.onError(this.props.intl.formatMessage(messages.file_attachment_too_large,\n        {size: bytesToHumanSize(file.size), limit: bytesToHumanSize(maxExternAttachmentSize)}), 'err');\n    } else {\n      this.setState({\n        docPreview: {\n          file: file,\n          name: file.name,\n          size: file.size,\n          type: file.type\n        }\n      });\n    }\n  }\n\n  handleCallHangup(topic, seq) {\n    this.props.onVideoCallClosed();\n    this.setState({\n      rtcPanel: null\n    });\n    this.props.onCallHangup(topic, seq);\n  }\n\n  handleCallPanelToggle() {\n    this.setState({minimizedCallPanel: !this.state.minimizedCallPanel});\n  }\n\n  // sendImageAttachment sends the image bits as Drafty message.\n  sendImageAttachment(caption, blob) {\n    const mime = this.state.imagePreview.mime;\n    const width = this.state.imagePreview.width;\n    const height = this.state.imagePreview.height;\n    const fname = this.state.imagePreview.filename;\n\n    // Server-provided limit reduced for base64 encoding and overhead.\n    const maxInbandAttachmentSize = (this.props.tinode.getServerParam('maxMessageSize',\n      MAX_INBAND_ATTACHMENT_SIZE) * 0.75 - 1024) | 0;\n\n    if (blob.size > maxInbandAttachmentSize) {\n      // Too large to send inband - uploading out of band and sending as a link.\n      const uploader = this.props.tinode.getLargeFileHelper();\n      if (!uploader) {\n        this.props.onError(this.props.intl.formatMessage(messages.cannot_initiate_upload));\n        return;\n      }\n      const uploadCompletionPromise = uploader.upload(blob);\n\n      // Make small preview to show while uploading.\n      imageScaled(blob, IMAGE_PREVIEW_DIM, IMAGE_PREVIEW_DIM, -1, false)\n        // Convert tiny image into base64 for serialization and previewing.\n        .then(scaled => blobToBase64(scaled.blob))\n        .then(b64 => {\n          let msg = Drafty.insertImage(null, 0, {\n            mime: mime,\n            _tempPreview: b64.bits, // This preview will not be serialized.\n            bits: b64.bits, // Image thumbnail.\n            width: width,\n            height: height,\n            filename: fname,\n            size: blob.size,\n            urlPromise: uploadCompletionPromise\n          });\n          if (caption) {\n            msg = Drafty.appendLineBreak(msg);\n            msg = Drafty.append(msg, Drafty.parse(caption));\n          }\n          // Pass data and the uploader to the TinodeWeb.\n          this.sendMessage(msg, uploadCompletionPromise, uploader);\n        })\n        .catch(err => this.props.onError(err, 'err'));\n      return;\n    }\n\n    // Send the image inband if it's not too big. The image has been scaled already\n    // in image preview.\n    blobToBase64(blob)\n      .then(b64 => {\n        let msg = Drafty.insertImage(null, 0, {\n          mime: b64.mime,\n          bits: b64.bits,\n          width: width,\n          height: height,\n          filename: fname,\n          size: blob.size\n        });\n        if (caption) {\n          msg = Drafty.appendLineBreak(msg);\n          msg = Drafty.append(msg, Drafty.parse(caption));\n        }\n        this.sendMessage(msg);\n      });\n  }\n\n  // sendVideoAttachment sends the video bits as Drafty message.\n  sendVideoAttachment(caption, videoBlob, previewBlob, params) {\n    const width = params.width;\n    const height = params.height;\n\n    // Server-provided limit reduced for base64 encoding and overhead.\n    const maxInbandAttachmentSize = (this.props.tinode.getServerParam('maxMessageSize',\n      MAX_INBAND_ATTACHMENT_SIZE) * 0.75 - 1024) | 0;\n\n    const uploads = [];\n    let uploader;\n    if ((videoBlob.size + previewBlob.size) > maxInbandAttachmentSize) {\n      // One or both are too large to send inband. Uploading out of band and sending as a link.\n      uploader = this.props.tinode.getLargeFileHelper();\n      if (!uploader) {\n        this.props.onError(this.props.intl.formatMessage(messages.cannot_initiate_upload));\n        return;\n      }\n\n      uploads[0] = videoBlob.size > maxInbandAttachmentSize * 0.675 ? uploader.upload(videoBlob) : null;\n      uploads[1] = previewBlob.size > maxInbandAttachmentSize * 0.275 ? uploader.upload(previewBlob) : null;\n    }\n\n    if (uploads.length == 0) {\n      // Both video and preview are small enough to send inband.\n      Promise.all([blobToBase64(videoBlob), blobToBase64(previewBlob)])\n        .then(b64s => {\n          const [v64, i64] = b64s;\n          let msg = Drafty.insertVideo(null, 0, {\n            mime: v64.mime,\n            bits: v64.bits,\n            preview: i64.bits,\n            premime: i64.mime,\n            width: width,\n            height: height,\n            duration: params.duration,\n            filename: params.name,\n            size: videoBlob.size\n          });\n          if (caption) {\n            msg = Drafty.appendLineBreak(msg);\n            msg = Drafty.append(msg, Drafty.parse(caption));\n          }\n          this.sendMessage(msg);\n      });\n      return;\n    }\n\n    const uploadCompletionPromise = Promise.all(uploads);\n\n    const b64conv = [];\n    // Small video converted to base64.\n    b64conv[0] = uploads[0] ? null : blobToBase64(videoBlob);\n    // Full-size preview fits inline.\n    b64conv[1] = uploads[1] ? null : imageScaled(previewBlob, MAX_IMAGE_DIM, MAX_IMAGE_DIM, -1, false)\n      .then(scaled => blobToBase64(scaled.blob));\n    // Small preview to show while uploading.\n    b64conv[2] = imageScaled(previewBlob, VIDEO_PREVIEW_DIM, VIDEO_PREVIEW_DIM, -1, false)\n      .then(scaled => blobToBase64(scaled.blob));\n    // Convert tiny image into base64 for serialization and previewing.\n    Promise.all(b64conv)\n      .then(b64s => {\n        const [video, img, preview] = b64s;\n        let msg = Drafty.insertVideo(null, 0, {\n          mime: params.mime,\n          bits: video ? video.bits : null,\n          _tempPreview: preview.bits,\n          preview: img ? img.bits : preview.bits,\n          premime: img ? img.mime : preview.mime,\n          width: width,\n          height: height,\n          duration: params.duration,\n          filename: params.name,\n          size: videoBlob.size,\n          urlPromise: uploadCompletionPromise\n        });\n\n        if (caption) {\n          msg = Drafty.appendLineBreak(msg);\n          msg = Drafty.append(msg, Drafty.parse(caption));\n        }\n        // Pass data and the uploader to the TinodeWeb.\n        this.sendMessage(msg, uploadCompletionPromise, uploader);\n      })\n      .catch(err => this.props.onError(err.message, 'err'));\n  }\n\n  // handleAttachImageOrVideo method is called when [Attach image or video] button is clicked: launch image or video preview.\n  handleAttachImageOrVideo(file) {\n    const maxExternAttachmentSize = this.props.tinode.getServerParam('maxFileUploadSize', MAX_EXTERN_ATTACHMENT_SIZE);\n\n    if (file.type.startsWith('video/')) {\n      this.setState({videoPreview: {\n        url: URL.createObjectURL(file),\n        blob: file,\n        filename: file.name,\n        size: file.size,\n        mime: file.type\n      }});\n      return;\n    }\n\n    // Get image dimensions and size, optionally scale it down.\n    imageScaled(file, MAX_IMAGE_DIM, MAX_IMAGE_DIM, maxExternAttachmentSize, false)\n      .then(scaled => {\n        this.setState({imagePreview: {\n          url: URL.createObjectURL(scaled.blob),\n          blob: scaled.blob,\n          filename: scaled.name,\n          width: scaled.width,\n          height: scaled.height,\n          size: scaled.blob.size,\n          mime: scaled.mime\n        }});\n      }).catch(err => {\n        this.props.onError(err.message, 'err');\n      });\n  }\n\n  // handleFileDrop is called when the user drags & drops a file upon the message view.\n  handleFileDrop(files) {\n    if (!files || files.length == 0) {\n      return;\n    }\n    const file = files[0];\n    if (file.type && file.type.startsWith('image/')) {\n      this.handleAttachImageOrVideo(file);\n    } else {\n      this.handleAttachFile(file);\n    }\n  }\n\n  // sendAudioAttachment sends audio bits inband as Drafty message (no preview).\n  sendAudioAttachment(url, preview, duration) {\n    fetch(url)\n      .then(result => result.blob())\n      .then(blob => {\n        // Server-provided limit reduced for base64 encoding and overhead.\n        const maxInbandAttachmentSize = this.props.tinode.getServerParam('maxMessageSize', MAX_INBAND_ATTACHMENT_SIZE) * 0.75 - 1024;\n        if (blob.size > maxInbandAttachmentSize) {\n          // Too large to send inband - uploading out of band and sending as a link.\n          const uploader = this.props.tinode.getLargeFileHelper();\n          if (!uploader) {\n            this.props.onError(this.props.intl.formatMessage(messages.cannot_initiate_upload));\n            return;\n          }\n          const uploadCompletionPromise = uploader.upload(blob);\n          const msg = Drafty.appendAudio(null, {\n            mime: blob.type,\n            size: blob.size,\n            duration: duration,\n            preview: preview,\n            urlPromise: uploadCompletionPromise\n          });\n          // Pass data and the uploader to the TinodeWeb.\n          this.sendMessage(msg, uploadCompletionPromise, uploader);\n        } else {\n          // Small enough to send inband.\n          blobToBase64(blob)\n            .then(b64 => {\n              this.sendMessage(Drafty.appendAudio(null, {\n                mime: b64.mime,\n                bits: b64.bits,\n                size: blob.size,\n                duration: duration,\n                preview: preview,\n              }))\n            })\n        }\n      })\n      .catch(err => {this.props.onError(err.message, 'err')});;\n  }\n\n  handleCancelUpload(seq, uploader) {\n    const topic = this.props.tinode.getTopic(this.state.topic);\n    const found = topic.findMessage(seq);\n    if (found) {\n      found._cancelled = true;\n    }\n    uploader.cancel();\n  }\n\n  // seq: seq ID of the source message\n  // context: message content.\n  // senderId: UID of the sender of the source message.\n  // senderName: full name of the sender of the original message.\n  handlePickReply(seq, content, senderId, senderName) {\n    if (!seq || !content) {\n      this.setState({reply: null});\n      return;\n    }\n\n    content = typeof content == 'string' ? Drafty.init(content) : content;\n    if (Drafty.isValid(content)) {\n      content = Drafty.replyContent(content, QUOTED_REPLY_LENGTH);\n    } else {\n      // /!\\ invalid content.\n      content = Drafty.append(Drafty.init('\\u26A0 '),\n        Drafty.wrapInto(this.props.intl.formatMessage(messages.invalid_content), 'EM'));\n    }\n\n    this.setState({\n      reply: {\n        content: Drafty.quote(senderName, senderId, content),\n        seq: seq\n      }\n    });\n    this.props.onCancelForwardMessage();\n  }\n\n  // seq: seq ID of the message to edit.\n  // context: message content.\n  handleEditMessage(seq, content) {\n    if (!seq || !content) {\n      this.setState({reply: null});\n      return;\n    }\n\n    content = typeof content == 'string' ? Drafty.init(content) : content;\n    const editable = Drafty.toMarkdown(content);\n    if (Drafty.isValid(content)) {\n      content = Drafty.replyContent(content, EDIT_PREVIEW_LENGTH);\n    } else {\n      // /!\\ invalid content.\n      content = Drafty.append(Drafty.init('\\u26A0 '),\n        Drafty.wrapInto(this.props.intl.formatMessage(messages.invalid_content), 'EM'));\n    }\n\n    this.setState({\n      reply: {\n        content: Drafty.quote(this.props.intl.formatMessage(messages.editing_message), null, content),\n        seq: seq,\n        editing: true\n      },\n      contentToEdit: editable\n    });\n    this.props.onCancelForwardMessage();\n  }\n\n  handleCancelReply() {\n    this.setState({reply: null, contentToEdit: null});\n    this.props.onCancelForwardMessage();\n  }\n\n  handleQuoteClick(replyToSeq) {\n    const ref = this.getOrCreateMessageRef(replyToSeq);\n    if (ref && ref.current) {\n      ref.current.scrollIntoView({block: \"center\", behavior: \"smooth\"});\n      ref.current.classList.add('flash');\n      setTimeout(_ => {ref.current.classList.remove('flash')} , 1000);\n    } else {\n      console.error(\"Unresolved message ref\", replyToSeq);\n    }\n  }\n\n  handleUnpinMessage(seq) {\n    const topic = this.props.tinode.getTopic(this.state.topic);\n    topic.pinMessage(seq, false);\n  }\n\n  isDragEnabled() {\n    return this.state.isWriter && !this.state.unconfirmed && !this.props.forwardMessage && !this.state.peerMessagingDisabled;\n  }\n\n  handleDragStart(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    e.dataTransfer.clearData();\n  }\n\n  handleDragIn(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.dragCounter++;\n    if (e.dataTransfer.items && e.dataTransfer.items.length > 0) {\n      this.setState({dragging: true});\n    }\n  }\n\n  handleDragOut(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.dragCounter--;\n    if (this.dragCounter <= 0) {\n      this.setState({dragging: false});\n    }\n  }\n\n  handleDrag(e) {\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  handleDrop(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.setState({dragging: false});\n    if (this.isDragEnabled() && e.dataTransfer.files && e.dataTransfer.files.length > 0) {\n      this.handleFileDrop(e.dataTransfer.files);\n      this.dragCounter = 0;\n    }\n  }\n\n  render() {\n    const {formatMessage} = this.props.intl;\n\n    // P2P call is an overlay, not a separate component because it cannot be\n    // re-mounted between full screen/minimized.\n    const overlay = this.state.rtcPanel &&\n        <Suspense fallback={<div><FormattedMessage id=\"loading_note\" defaultMessage=\"Loading...\"\n            description=\"Message shown when component is loading\"/></div>}>\n          <CallPanel\n            topic={this.state.topic}\n            seq={this.props.callSeq}\n            callState={this.props.callState}\n            callAudioOnly={this.props.callAudioOnly}\n            tinode={this.props.tinode}\n            title={this.state.title}\n            avatar={this.state.avatar || true}\n            minimized={this.state.minimizedCallPanel}\n            onError={this.props.onError}\n            onHangup={this.handleCallHangup}\n            onToggleMinimize={this.handleCallPanelToggle}\n            onInvite={this.props.onCallInvite}\n            onSendOffer={this.props.onCallSendOffer}\n            onIceCandidate={this.props.onCallIceCandidate}\n            onSendAnswer={this.props.onCallSendAnswer} />\n        </Suspense>;\n\n    let component;\n    if (!this.state.topic) {\n      component = <LogoView\n          serverVersion={this.props.serverVersion}\n          serverAddress={this.props.serverAddress} />;\n\n    } else {\n      let component2;\n      if (this.state.imagePreview) {\n        // Preview image before sending.\n        component2 = (\n          <Suspense fallback={<div><FormattedMessage id=\"loading_note\" defaultMessage=\"Loading...\"\n            description=\"Message shown when component is loading\"/></div>}>\n            <ImagePreview\n              content={this.state.imagePreview}\n              tinode={this.props.tinode}\n              reply={this.state.reply}\n              onCancelReply={this.handleCancelReply}\n              onClose={this.handleClosePreview}\n              onSendMessage={this.sendImageAttachment} />\n          </Suspense>\n        );\n      } else if (this.state.videoPreview) {\n          // Preview video.\n        component2 = <Suspense fallback={<div><FormattedMessage id=\"loading_note\" defaultMessage=\"Loading...\"\n            description=\"Message shown when component is loading\"/></div>}>\n            <VideoPreview\n              content={this.state.videoPreview}\n              tinode={this.props.tinode}\n              reply={this.state.reply}\n              onError={this.props.onError}\n              onCancelReply={this.handleCancelReply}\n              onClose={this.handleClosePreview}\n              onSendMessage={this.sendVideoAttachment} />\n          </Suspense>;\n\n      } else if (this.state.imagePostview) {\n        // Expand received image.\n        component2 = <Suspense fallback={<div><FormattedMessage id=\"loading_note\" defaultMessage=\"Loading...\"\n            description=\"Message shown when component is loading\"/></div>}>\n            <ImagePreview\n              content={this.state.imagePostview}\n              onClose={this.handleClosePreview} />\n          </Suspense>;\n\n      } else if (this.state.videoPostview) {\n        // Play received video.\n        component2 = <Suspense fallback={<div><FormattedMessage id=\"loading_note\" defaultMessage=\"Loading...\"\n            description=\"Message shown when component is loading\"/></div>}>\n            <VideoPreview\n              content={this.state.videoPostview}\n              tinode={this.props.tinode}\n              onError={this.props.onError}\n              onClose={this.handleClosePreview} />\n          </Suspense>;\n\n      } else if (this.state.docPreview) {\n        // Preview attachment before sending.\n        if (TheCard.isFileSupported(this.state.docPreview.type, this.state.docPreview.name) ||\n            this.state.docPreview.type == TheCard.contentType) {\n          component2 = <Suspense fallback={<div><FormattedMessage id=\"loading_note\" defaultMessage=\"Loading...\"\n            description=\"Message shown when component is loading\"/></div>}>\n            <TheCardPreview\n              content={this.state.docPreview}\n              tinode={this.props.tinode}\n              reply={this.state.reply}\n              onCancelReply={this.handleCancelReply}\n              onClose={this.handleClosePreview}\n              onSendMessage={this.sendFileAttachment} />\n          </Suspense>;\n        } else {\n          component2 = <Suspense fallback={<div><FormattedMessage id=\"loading_note\" defaultMessage=\"Loading...\"\n              description=\"Message shown when component is loading\"/></div>}>\n              <DocPreview\n                content={this.state.docPreview}\n                tinode={this.props.tinode}\n                reply={this.state.reply}\n                onCancelReply={this.handleCancelReply}\n                onClose={this.handleClosePreview}\n                onSendMessage={this.sendFileAttachment} />\n            </Suspense>;\n        }\n      } else {\n        const topic = this.props.tinode.getTopic(this.state.topic);\n        const isChannel = topic.isChannelType() || topic.chan;\n        const groupTopic = topic.isGroupType() && !isChannel;\n        const icon_badges = [];\n        if (topic.trusted) {\n          if (topic.trusted.verified) {\n            icon_badges.push({icon: 'verified', color: 'badge-inv'});\n          }\n          if (topic.trusted.staff) {\n            icon_badges.push({icon: 'staff', color: 'badge-inv'});\n          }\n          if (topic.trusted.danger) {\n            icon_badges.push({icon: 'dangerous', color: 'badge-inv'});\n          }\n        }\n\n        const pinnedMessages = [];\n        this.state.pins.forEach(seq => pinnedMessages.push(topic.latestMsgVersion(seq) || topic.findMessage(seq)));\n\n        const messageNodes = [];\n        let previousFrom = null;\n        let prevDate = null;\n        let chatBoxClass = null;\n        topic.messages((msg, prev, next, i) => {\n          let nextFrom = next ? (next.from || 'chan') : null;\n\n          let sequence = 'single';\n          let thisFrom = msg.from || 'chan';\n          if (thisFrom == previousFrom) {\n            if (thisFrom == nextFrom) {\n              sequence = 'middle';\n            } else {\n              sequence = 'last';\n            }\n          } else if (thisFrom == nextFrom) {\n            sequence = 'first';\n          }\n          previousFrom = thisFrom;\n\n          const isReply = !(thisFrom == this.props.myUserId);\n          const deliveryStatus = topic.msgStatus(msg, true);\n\n          let userFrom = thisFrom, userName, userAvatar;\n          const user = topic.userDesc(thisFrom);\n          if (user && user.public) {\n            userName = user.public.fn;\n            userAvatar = makeImageUrl(user.public.photo);\n          }\n          chatBoxClass = groupTopic ? 'chat-box group' : 'chat-box';\n\n          // Ref for this chat message.\n          const ref = this.getOrCreateMessageRef(msg.seq);\n          let replyToSeq = msg.head ? parseInt(msg.head.reply) : null;\n          if (!replyToSeq || isNaN(replyToSeq)) {\n            replyToSeq = null;\n          }\n\n          if (msg.hi) {\n            // Deleted message.\n            messageNodes.push(\n              <MetaMessage\n                deleted={true}\n                key={msg.seq} />\n              );\n          } else {\n            const thisDate = new Date(msg.ts);\n            // This message was sent on a different date than the previous.\n            if (!prevDate || prevDate.toDateString() != thisDate.toDateString()) {\n              messageNodes.push(\n                <MetaMessage\n                  date={relativeDateFormat(msg.ts)}\n                  locale={this.props.intl.locale}\n                  key={'date-' + msg.seq} />\n              );\n              prevDate = thisDate;\n            }\n            messageNodes.push(\n              <ChatMessage\n                tinode={this.props.tinode}\n                topic={this.state.topic}\n                content={msg.content}\n                mimeType={msg.head && msg.head.mime}\n                replyToSeq={replyToSeq}\n                edited={msg.head && !msg.head.webrtc && msg.head.replace}\n                timestamp={msg.ts}\n                response={isReply}\n                seq={msg.seq}\n                isGroup={groupTopic}\n                isChan={this.state.channel}\n                userFrom={userFrom}\n                userName={userName}\n                userAvatar={userAvatar}\n                sequence={sequence}\n                received={deliveryStatus}\n                uploader={msg._uploader}\n                userIsWriter={this.state.isWriter}\n                userIsAdmin={this.state.isAdmin}\n                showPicker={this.state.reactionPickerShownFor == msg.seq}\n                pinned={this.state.pins.includes(msg.seq)}\n                viewportWidth={this.props.viewportWidth}  // Used by `formatter`.\n                reactions={topic.msgReactions(msg.seq)}\n                reactionList={this.state.reactionList}\n                maxReactions={this.state.maxReactions}\n                showContextMenu={this.handleShowMessageContextMenu}\n                onExpandMedia={this.handleExpandMedia}\n                onFormResponse={this.handleFormResponse}\n                onCancelUpload={this.handleCancelUpload}\n                pickReply={this.handlePickReply}\n                editMessage={this.handleEditMessage}\n                onQuoteClick={this.handleQuoteClick}\n                onAcceptCall={this.props.onAcceptCall}\n                onError={this.props.onError}\n                onReact={this.handleReact}\n                onToggleReactionPicker={this.handleToggleReactionPicker}\n                myUserId={this.props.myUserId}\n                parentRef={this.messagesScroller}\n                ref={ref}\n                key={msg.seq} />\n            );\n          }\n        });\n\n        let lastSeen = null;\n        if (isChannel) {\n          if (topic.subcnt) {\n            lastSeen = formatMessage(messages.subscriber_count, {count: topic.subcnt});\n          }\n        } else {\n          const cont = this.props.tinode.getMeTopic().getContact(this.state.topic);\n          if (cont) {\n            if (Tinode.isP2PTopicName(cont.topic)) {\n              if (cont.online) {\n                lastSeen = formatMessage(messages.online_now);\n              } else if (cont.seen) {\n                lastSeen = formatMessage(messages.last_seen,\n                  {timestamp: shortDateFormat(cont.seen.when, this.props.intl.locale)});\n                // TODO: also handle user agent in c.seen.ua\n              }\n            } else if (Tinode.isGroupTopicName(cont.topic)) {\n              if (topic.subcnt) {\n                lastSeen = formatMessage(messages.member_count, {count: topic.subcnt});\n              }\n            }\n          }\n        }\n        const avatar = this.state.avatar || true;\n        const online = this.state.deleted || topic.isSelfType() ? null :\n          this.props.online ? 'online' + (this.state.typingIndicator ? ' typing' : '') : 'offline';\n\n        const titleClass = 'panel-title' + (this.state.deleted ? ' deleted' : '');\n        const darkModeClass = this.props.colorSchema == 'dark' ? 'dark' : '';\n\n        let messagesComponent = (\n          <>\n            <div id=\"messages-container\" className={darkModeClass}>\n              <button id=\"go-to-latest\" className={'action-button' + (this.state.showGoToLastButton ? '' : ' hidden')}\n                onClick={this.goToLatestMessage}>\n                <i className=\"m-icon\">arrow_downward</i>\n              </button>\n              <div id=\"messages-panel\" ref={this.handleScrollReference}>\n                <ul id=\"scroller\" className={chatBoxClass}>\n                  {messageNodes}\n                </ul>\n              </div>\n              {!this.state.isReader ?\n              <div id=\"write-only-background\">\n                {this.state.readingBlocked ?\n                <div id=\"write-only-note\">\n                  <FormattedMessage id=\"messages_not_readable\" defaultMessage=\"no access to messages\"\n                    description=\"Message shown in topic without the read access\" />\n                </div>\n                : null }\n              </div>\n              : null }\n            </div>\n            {this.state.peerMessagingDisabled && !this.state.unconfirmed ?\n              <div id=\"peer-messaging-disabled-note\">\n                <i className=\"m-icon secondary\">block</i> <FormattedMessage\n                  id=\"peers_messaging_disabled\" defaultMessage=\"Peer's messaging is disabled.\"\n                  description=\"Shown when the p2p peer's messaging is disabled\" /> <a href=\"#\"\n                    onClick={this.handleEnablePeer}><FormattedMessage id=\"enable_peers_messaging\"\n                    defaultMessage=\"Enable\" description=\"Call to action to enable peer's messaging\" /></a>.\n              </div> : null}\n            {this.state.unconfirmed ?\n              <Invitation onAction={this.handleNewChatAcceptance} />\n              :\n              <SendMessage\n                tinode={this.props.tinode}\n                topicName={this.state.topic}\n                noInput={!!this.props.forwardMessage}\n                disabled={!this.state.isWriter || this.state.deleted}\n                reply={this.state.reply}\n                initMessage={this.state.contentToEdit}\n                sendOnEnter={this.props.sendOnEnter}\n                onKeyPress={this.sendKeyPress}\n                onRecordingProgress={this.sendKeyPress}\n                onSendMessage={this.sendMessage}\n                onAttachFile={this.props.forwardMessage ? null : this.handleAttachFile}\n                onAttachImage={this.props.forwardMessage ? null : this.handleAttachImageOrVideo}\n                onAttachAudio={this.props.forwardMessage ? null : this.sendAudioAttachment}\n                onError={this.props.onError}\n                onQuoteClick={this.handleQuoteClick}\n                onCancelReply={this.handleCancelReply} />}\n          </>\n        );\n\n        component2 = (\n          <>\n            <div id=\"topic-caption-panel\" className=\"caption-panel\">\n              {this.props.displayMobile ?\n                <a href=\"#\" id=\"hide-message-view\" onClick={(e) => {e.preventDefault(); this.leave(this.state.topic); this.props.onHideMessagesView();}}>\n                  <i className=\"m-icon\">arrow_back</i>\n                </a>\n                :\n                null}\n              <div className=\"avatar-box\">\n                <LetterTile\n                  authorizeURL={this.props.tinode.authorizeURL}\n                  avatar={avatar}\n                  topic={this.state.topic}\n                  title={this.state.title}\n                  deleted={this.state.deleted} />\n                {!isChannel ? <span className={online} /> : null}\n              </div>\n              <div id=\"topic-title-group\">\n                <div id=\"topic-title\" className={titleClass}>{\n                  this.state.title ||\n                  <i><FormattedMessage id=\"unnamed_topic\" defaultMessage=\"Unnamed\"\n                    description=\"Title shown when the topic has no name\" /></i>\n                }<ContactBadges badges={icon_badges} /></div>\n                <div id=\"topic-last-seen\">{lastSeen}</div>\n              </div>\n              <div style={{marginLeft: 'auto'}}/>\n              {!this.props.displayMobile && this.state.pins.length > 0 ?\n                <PinnedMessages\n                  tinode={this.props.tinode}\n                  pins={this.state.pins}\n                  messages={pinnedMessages}\n                  selected={this.state.selectedPin}\n                  isAdmin={this.state.isAdmin}\n                  setSelected={index => this.setState({selectedPin: index})}\n                  onSelected={this.handleQuoteClick}\n                  onCancel={this.handleUnpinMessage} />\n                : null}\n              {groupTopic ?\n                <GroupSubs\n                  tinode={this.props.tinode}\n                  subscribers={this.state.onlineSubs} /> :\n                null\n              }\n              <div>\n                <a href=\"#\" onClick={this.handleContextClick}>\n                  <i className=\"m-icon\">more_vert</i>\n                </a>\n              </div>\n            </div>\n            {this.props.displayMobile ?\n              <>\n                {this.state.pins.length > 0 ?\n                  <PinnedMessages\n                    tinode={this.props.tinode}\n                    pins={this.state.pins}\n                    messages={pinnedMessages}\n                    selected={this.state.selectedPin}\n                    isAdmin={this.state.isAdmin}\n                    setSelected={index => this.setState({selectedPin: index})}\n                    onSelected={this.handleQuoteClick}\n                    onCancel={this.handleUnpinMessage} />\n                    : null\n                }\n                <ErrorPanel\n                  level={this.props.errorLevel}\n                  text={this.props.errorText}\n                  onClearError={this.props.onError} />\n              </>\n              : null}\n            <LoadSpinner show={this.state.fetchingMessages} />\n            {messagesComponent}\n            {this.state.dragging && this.isDragEnabled() ?\n              <div className=\"drag-n-drop\">{formatMessage(messages.drag_file)}</div>\n            : null}\n          </>\n        );\n      }\n      component = <div id=\"topic-view\" ref={this.mountComponentEvents}>{component2}{overlay}</div>\n    }\n    return component;\n  }\n};\n\nexport default injectIntl(MessagesView);\nexport { MessagesView as UnwrappedMessagesView };\n","import React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport FileProgress from './file-progress.jsx';\nimport { bytesToHumanSize } from '../lib/strformat.js';\nimport { isUrlRelative, sanitizeUrl } from '../lib/utils.js';\n\nexport default class Attachment extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      downloader: null,\n      progress: 0\n    };\n\n    this.downloadFile = this.downloadFile.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n  }\n\n  downloadFile(url, filename, mimetype) {\n    if (!url) {\n      this.props.onError(\"Invalid download URL '\" + url + \"'\");\n      return;\n    }\n\n    const downloader = this.props.tinode.getLargeFileHelper();\n    this.setState({downloader: downloader});\n    downloader.download(url, filename, mimetype,\n      loaded => this.setState({progress: loaded / this.props.size}),\n      err => this.props.onError(err, 'err')\n    )\n    .then(_ => this.setState({downloader: null, progress: 0}))\n    .catch(err => {\n      if (err) {\n        this.props.onError(\"Error downloading file: \" + err.message, 'err');\n      }\n      this.setState({downloader: null, progress: 0});\n    });\n  }\n\n  handleCancel() {\n    if (this.props.uploading) {\n      this.props.onCancelUpload();\n    } else if (this.state.downloader) {\n      this.state.downloader.cancel();\n    }\n  }\n\n  render() {\n    let filename = this.props.filename || 'file_attachment';\n    if (filename.length > 36) {\n      filename = filename.substr(0, 16) + '...' + filename.substr(-16);\n    }\n    let size = this.props.size > 0 ?\n      <span className=\"small gray\">({bytesToHumanSize(this.props.size)})</span> :\n      null;\n\n    // Detect if the download URL is relative or absolute.\n    // If the URL is relative use LargeFileHelper to attach authentication\n    // credentials to the request.\n    let url, helperFunc;\n    if (!this.props.uploading && !this.state.downloader && isUrlRelative(this.props.downloadUrl)) {\n      // Relative URL. Use download helper.\n      url = '#';\n      helperFunc = (e) => {\n        e.preventDefault();\n        this.downloadFile(this.props.downloadUrl, this.props.filename, this.props.mimetype);\n      };\n    } else {\n      url = sanitizeUrl(this.props.downloadUrl);\n      helperFunc = null;\n    }\n    const downloadWidget = <><i className=\"m-icon\">file_download</i> <FormattedMessage id=\"save_attachment\"\n      defaultMessage=\"save\" description=\"Call to save an attachment\" /></>;\n    return (\n      <div className=\"attachment\">\n        <div><i className=\"m-icon big gray thin\">draft</i></div>\n        <div className=\"flex-column\">\n          <div>{filename} {size}</div>\n          {this.props.uploading || this.state.downloader ?\n            <FileProgress progress={this.props.uploading ? this.props.progress : this.state.progress}\n              onCancel={this.handleCancel} />\n            :\n            <div>{url ?\n              <a href={url} download={this.props.filename} onClick={helperFunc}>{downloadWidget}</a>\n              :\n              <span className=\"light-gray\">{downloadWidget}</span>\n            }</div>\n          }\n        </div>\n      </div>\n    );\n  }\n};\n","// Single chat message bubble, sent or received.\n\nimport React from 'react';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport { Drafty, Tinode, TheCard } from 'tinode-sdk';\n\nimport Attachment from './attachment.jsx';\nimport LetterTile from './letter-tile.jsx';\nimport ReactionStrip from './reaction-strip.jsx';\nimport ReceivedMarker from './received-marker.jsx'\n\nimport { fullFormatter } from '../lib/formatters.js';\nimport { sanitizeUrl } from '../lib/utils.js';\nimport ReactionPicker from './reaction-picker.jsx';\nimport HashNavigation from '../lib/navigation.js';\n\n/*\nconst testReactions = [\n  {val: '', count: 2, users: ['user1', 'user2']},\n  {val: '', count: 1, users: ['user3']},\n  {val: '', count: 5, users: ['user4', 'user5', 'user6', 'user7', 'user8']},\n  {val: '', count: 3, users: ['user9', 'user10', 'user11']},\n  {val: \"\", count: 1, users: ['user1']},\n  {val: \"\", count: 2, users: ['user1', 'user2']},\n  {val: \"\", count: 1, users: ['user1']},\n  {val: \"\", count: 1, users: ['user1']},\n  {val: \"\", count: 4, users: ['user1', 'user2', 'user3', 'user4']},\n  {val: \"\", count: 1, users: ['user1']},\n  {val: \"\", count: 2, users: ['user1', 'user2']},\n  {val: \"\", count: 1, users: ['user1']}\n];\n*/\n\nclass BaseChatMessage extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      progress: 0\n    };\n\n    if (props.uploader) {\n      props.uploader.onProgress = this.handleProgress.bind(this);\n    }\n\n    this.handleExpandImage = this.handleExpandImage.bind(this);\n    this.handlePlayVideo = this.handlePlayVideo.bind(this);\n    this.handleFormButtonClick = this.handleFormButtonClick.bind(this);\n    this.handleQuoteClick = this.handleQuoteClick.bind(this);\n    this.handleContextClick = this.handleContextClick.bind(this);\n    this.handleCancelUpload = this.handleCancelUpload.bind(this);\n    this.handleQuoteClick = this.handleQuoteClick.bind(this);\n    this.handleTogglePicker = this.handleTogglePicker.bind(this);\n    this.handleReactionSelected = this.handleReactionSelected.bind(this);\n    this.handleDraftyClick = this.handleDraftyClick.bind(this);\n\n    this.formatterContext = {\n      formatMessage: props.intl.formatMessage.bind(props.intl),\n      viewportWidth: props.viewportWidth,\n      authorizeURL: props.tinode.authorizeURL.bind(props.tinode),\n\n      onHandleClick: this.handleDraftyClick\n    };\n  }\n\n  handleDraftyClick = (e, action) => {\n    switch (action) {\n      case 'image':\n        this.handleExpandImage(e);\n        break;\n      case 'video':\n        this.handlePlayVideo(e);\n        break;\n      case 'form_button':\n        this.handleFormButtonClick(e);\n        break;\n      case 'quote':\n        this.handleQuoteClick(e);\n        break;\n      case 'contact_chat':\n        e.preventDefault();\n        try {\n          // tinode:id/usr123abc -> usr123abc\n          const pathname = new URL(e.target.dataset.val)?.pathname;\n          const parts = pathname.split('/').filter(Boolean);\n          HashNavigation.navigateTo(HashNavigation.setUrlTopic('', parts.pop() || ''));\n        } catch (error) {\n          console.error(\"Invalid URL:\", error);\n        }\n        break;\n      case 'contact_find':\n        e.preventDefault();\n        let hashUrl = HashNavigation.setUrlSidePanel(window.location.hash, 'newtpk');\n        hashUrl = HashNavigation.addUrlParam(hashUrl, 'q', e.target.dataset.val);\n        hashUrl = HashNavigation.addUrlParam(hashUrl, 'tab', 'find');\n        HashNavigation.navigateTo(hashUrl);\n        break;\n      default:\n        // No special handling; let the browser deal with it.\n        console.info('Unhandled drafty action.', action, e.target.dataset);\n        break;\n    }\n  }\n\n  handleExpandImage(e) {\n    e.preventDefault();\n    this.props.onExpandMedia({\n      url: e.target.src,\n      filename: e.target.dataset.name,\n      width: e.target.dataset.width,\n      height: e.target.dataset.height,\n      size: e.target.dataset.size,\n      type: e.target.dataset.mime\n    });\n  }\n\n  handlePlayVideo(e) {\n    e.preventDefault();\n    this.props.onExpandMedia({\n      video: true,\n      url: e.target.dataset.src,\n      preview: e.target.src,\n      filename: e.target.dataset.name,\n      width: e.target.dataset.width,\n      height: e.target.dataset.height,\n      duration: e.target.dataset.duration,\n      size: e.target.dataset.size,\n      type: e.target.dataset.mime\n    });\n  }\n\n  handleFormButtonClick(e) {\n    e.preventDefault();\n    const data = {\n      seq: this.props.seq\n    };\n    data.resp = {};\n    if (e.target.dataset.name) {\n      data.resp[e.target.dataset.name] = e.target.dataset.val ? e.target.dataset.val :\n        e.target.dataset.val === undefined ? 1 : '' + e.target.dataset.val;\n    }\n    if (e.target.dataset.act == 'url') {\n      data.ref = sanitizeUrl(e.target.dataset.ref) || 'about:blank';\n    }\n    const text = e.target.dataset.title || 'unknown';\n    this.props.onFormResponse(e.target.dataset.act, text, data);\n  }\n\n  handleContextClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    const menuItems = [];\n    if (this.props.received == Tinode.MESSAGE_STATUS_FAILED) {\n      menuItems.push('menu_item_send_retry');\n    }\n    if (this.props.received > Tinode.MESSAGE_STATUS_FATAL) {\n      if (this.props.userIsWriter) {\n        menuItems.push('menu_item_reply');\n        if (!this.props.response) {\n          let immutable = false;\n          Drafty.entities(this.props.content, (_0, _1, tp) => {\n            immutable = ['AU', 'EX', 'FM', 'IM', 'TC', 'VC', 'VD'].includes(tp);\n            return immutable;\n          });\n          if (!immutable) {\n            Drafty.styles(this.props.content, tp => {\n              immutable = ['QQ'].includes(tp);\n              return immutable;\n            });\n          }\n          if (!immutable) {\n            menuItems.push('menu_item_edit');\n          }\n        }\n      }\n      if (this.props.userIsAdmin) {\n        menuItems.push(this.props.pinned ? 'menu_item_unpin' : 'menu_item_pin');\n      }\n    }\n    menuItems.push('menu_item_forward');\n\n    this.props.showContextMenu({\n      seq: this.props.seq,\n      replace: this.props.edited ? parseInt(this.props.edited.split(':')[1]) : 0,\n      content: this.props.content,\n      userFrom: this.props.userFrom,\n      userName: this.props.userName,\n      y: e.pageY,\n      x: e.pageX,\n      pickReply: this.props.pickReply,\n      editMessage: this.props.editMessage,\n      timestamp: this.props.timestamp,\n    }, menuItems);\n  }\n\n  handleProgress(ratio) {\n    this.setState({progress: ratio});\n  }\n\n  handleCancelUpload() {\n    this.props.onCancelUpload(this.props.seq, this.props.uploader);\n  }\n\n  handleQuoteClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    const replyToSeq = this.props.replyToSeq;\n    if (replyToSeq) {\n      this.props.onQuoteClick(replyToSeq);\n    }\n  }\n\n  handleTogglePicker(e) {\n    e.preventDefault();\n\n    if (this.props.showPicker) {\n      this.props.onToggleReactionPicker(-1);\n      return;\n    }\n\n    // Capture app bounds so the picker can position itself.\n    // Center of the button is used as the click coordinates.\n    const parentRect = this.props.parentRef.getBoundingClientRect();\n    const buttonRect = e.target.getBoundingClientRect();\n    this.setState({\n      pickerAnchor: {\n        viewX: buttonRect.left + buttonRect.width / 2 - parentRect.left,\n        viewY: buttonRect.top + buttonRect.height / 2 - parentRect.top,\n        offsetX: e.target.offsetLeft,\n        offsetY: e.target.offsetTop\n      },\n      parentBounds: {\n        width: parentRect.right - parentRect.left,\n        height: parentRect.bottom - parentRect.top,\n      }\n    });\n\n    this.props.onToggleReactionPicker(this.props.seq);\n  }\n\n  handleReactionSelected(e, emo) {\n    this.props.onReact(this.props.seq, emo);\n  }\n\n  render() {\n    const sideClass = this.props.sequence + ' ' + (this.props.response ? 'left' : 'right');\n    const bubbleClass = (this.props.sequence == 'single' || this.props.sequence == 'last') ? 'bubble tip' : 'bubble';\n    const avatar = this.props.userAvatar || true;\n    let textSizeClass = 'message-content';\n    const fullDisplay = (this.props.isGroup && this.props.response &&\n      (this.props.sequence == 'single' || this.props.sequence == 'last'));\n\n    let content = this.props.content;\n    const attachments = [];\n    if (this.props.mimeType == Drafty.getContentType() && Drafty.isValid(content)) {\n      Drafty.attachments(content, (att, i) => {\n        if (Drafty.isFormResponseType(att.mime)) {\n          // Don't show json drafty form response objects as attachments.\n          // They are not meant for users.\n          return;\n        }\n        attachments.push(<Attachment\n          tinode={this.props.tinode}\n          downloadUrl={Drafty.getDownloadUrl(att)}\n          filename={att.name}\n          uploading={Drafty.isProcessing(att)}\n          mimetype={att.mime}\n          size={Drafty.getEntitySize(att)}\n          progress={this.state.progress}\n          onCancelUpload={this.handleCancelUpload}\n          onError={this.props.onError}\n          key={i} />);\n      }, this);\n      const tree = Drafty.format(content, fullFormatter, this.formatterContext);\n      content = React.createElement(React.Fragment, null, tree);\n    } else if (typeof content == 'string') {\n      // Make font bigger for emoji-only messages.\n      // Must use 'new RegExp(...)' because React does not like /{1-5}/.\n      if (new RegExp('^\\\\p{RGI_Emoji}{1,5}$', 'v').test(content || '')) {\n        // Content consists of 1-5 emoji characters. Count how many and use it to increase the font size.\n        textSizeClass += ' emoji-' + (content || '').match(/\\p{RGI_Emoji}/vg).length;\n      }\n    } else {\n      content = <><i className=\"m-icon gray\">warning_amber</i> <i className=\"gray\">\n        <FormattedMessage id=\"invalid_content\"\n          defaultMessage=\"invalid content\" description=\"Shown when the message is unreadable\" /></i></>\n    }\n\n    return (\n      <li ref={this.props.innerRef} className={sideClass}>\n        {this.props.isGroup && this.props.response ?\n          <div className=\"avatar-box\">\n            {fullDisplay ?\n              <LetterTile\n                authorizeURL={this.props.tinode.authorizeURL}\n                topic={this.props.userFrom}\n                title={this.props.userName}\n                avatar={avatar} /> :\n              null}\n          </div> :\n          null}\n        <div>\n          <div className={bubbleClass}>\n            <div className=\"content-meta\">\n              <div className={textSizeClass}>\n                {content}\n                {attachments}\n              </div>\n              {this.props.reactionList ?\n                <ReactionStrip\n                  reactions={this.props.reactions}\n                  reactionList={this.props.reactionList}\n                  maxReactions={this.props.maxReactions}\n                  myUserId={this.props.myUserId}\n                  pickerShown={this.props.showPicker}\n                  onTogglePicker={this.handleTogglePicker}\n                  onReactionSelected={this.handleReactionSelected} />\n                : <div style={{height: '0.25rem'}}></div>\n              }\n              {this.props.timestamp ?\n                <ReceivedMarker\n                  edited={this.props.edited}\n                  timestamp={this.props.timestamp}\n                  received={this.props.received}\n                  style={{ marginBottom: this.props.reactionList ? 'unset' : '0.25rem' }} />\n                : null}\n            </div>\n            {this.props.showContextMenu ?\n              <span className=\"menuTrigger\">\n                <a href=\"#\" onClick={this.handleContextClick}>\n                  <i className=\"m-icon\">expand_more</i>\n                </a>\n              </span> : null\n            }\n          </div>\n          {this.props.showPicker ?\n            <ReactionPicker\n              reactions={this.props.reactions}\n              reactionList={this.props.reactionList}\n              maxReactions={this.props.maxReactions}\n              myUserId={this.props.myUserId}\n              leftBubble={this.props.response}\n              anchor={this.state.pickerAnchor}\n              viewportBounds={this.state.parentBounds}\n              onSelect={(emo) => this.handleReactionSelected(null, emo)}\n              onClose={() => this.props.onToggleReactionPicker(-1)}\n              dataTestPrefix=\"reaction-picker\" />\n            : null}\n          {fullDisplay ?\n            <div className=\"author\">\n              {this.props.userName ||\n                <i><FormattedMessage id=\"user_not_found\" defaultMessage=\"Not found\"\n                  description=\"In place of a user's full name when the user is not found.\" /></i>\n              }\n            </div>\n            : null\n          }\n        </div>\n      </li>\n    );\n  }\n};\n\nconst IntlChatMessage = injectIntl(BaseChatMessage);\nconst ChatMessage = React.forwardRef((props, ref) => <IntlChatMessage innerRef = {ref} {...props} />);\n\nexport default ChatMessage;\n","// GroupSubs: a list of group subscribers currently online.\n// Show in the topic title bar\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport { MAX_ONLINE_IN_TOPIC } from '../config.js'\n\nimport LetterTile from './letter-tile.jsx';\nimport { makeImageUrl } from '../lib/blob-helpers.js';\n\nexport default class GroupSubs extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const usersOnline = [];\n    const totalCount = (this.props.subscribers || []).length;\n    const countToShow = Math.min(MAX_ONLINE_IN_TOPIC, totalCount);\n\n    (this.props.subscribers || []).some((sub) => {\n      usersOnline.push(\n        <div className=\"avatar-box\" key={sub.user}>\n          <LetterTile\n            authorizeURL={this.props.tinode.authorizeURL}\n            topic={sub.user}\n            avatar={makeImageUrl(sub.public ? sub.public.photo : null) || true}\n            title={sub.public ? sub.public.fn : null} />\n        </div>\n      );\n      return usersOnline.length == countToShow;\n    });\n    if (usersOnline.length == 0) {\n      return null;\n    }\n    return (\n      <div id=\"topic-users\">{usersOnline} {totalCount > countToShow ?\n        <span>\n          <FormattedMessage id=\"more_online_members\" defaultMessage=\"+{overflow} more\"\n              description=\"Shown in MessagesView title bar when the number of online subscribers exceeds MAX_ONLINE_IN_TOPIC\"\n              values={{ overflow: (totalCount - countToShow) }} />\n        </span> : null}\n      </div>\n    );\n  }\n};\n","// A single topic or user.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport default class Invitation extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.handleButtonAction = this.handleButtonAction.bind(this);\n  }\n\n  handleButtonAction(evt, data) {\n    evt.preventDefault();\n    this.props.onAction(data);\n  }\n\n  render() {\n    return (\n      <div className=\"accept-invite-panel\">\n        <div className=\"title\">\n          <FormattedMessage id=\"chat_invitation\"\n            defaultMessage=\"You are invited to start a new chat. What would you like to do?\"\n            description=\"New chat invitation message: [Accept] [Ignore] [Block].\" />\n        </div>\n        <div className=\"footer\">\n          <button className=\"primary\" onClick={event => { this.handleButtonAction(event, \"accept\"); }}>\n            <FormattedMessage id=\"chat_invitation_accept\"\n              defaultMessage=\"Accept\" description=\"Action [Accept] for chat invitation.\" />\n          </button>\n          <button className=\"secondary\" onClick={event => { this.handleButtonAction(event, \"delete\"); }}>\n            <FormattedMessage id=\"chat_invitation_ignore\"\n              defaultMessage=\"Ignore\" description=\"Action [Ignore] for chat invitation.\" />\n          </button>\n          <button className=\"secondary\" onClick={event => { this.handleButtonAction(event, \"block\"); }}>\n            <FormattedMessage id=\"chat_invitation_block\"\n              defaultMessage=\"Block\" description=\"Action [Block] for chat invitation.\" />\n          </button>\n        </div>\n      </div>\n    );\n  }\n};\n","// Message bubble with non-payload content, such as an indicator of deleted content or a date stamp.\n\nimport React from 'react';\n\nexport default class MetaMessage extends React.PureComponent {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let content = null;\n    let bubbleClass = 'bubble';\n    if (this.props.date) {\n      // A date badge.\n      content = <>{this.props.date}</>\n      bubbleClass += ' date';\n    }\n\n    if (!content) {\n      return <>{null}</>\n    }\n\n    return (\n      <li className=\"meta\">\n        <div className={bubbleClass}>\n          <div className=\"message-content\">\n            {content}\n          </div>\n        </div>\n      </li>\n    );\n  }\n};\n","// Send message form.\nimport React from 'react';\nimport { defineMessages, injectIntl } from 'react-intl';\nimport { Drafty } from 'tinode-sdk';\n\nimport { previewFormatter } from '../lib/formatters.js';\nimport { MIN_SWIPE_DISTANCE } from '../config.js';\n\nconst messages = defineMessages({\n  message_not_found: {\n    id: 'message_not_found',\n    defaultMessage: 'message not found',\n    description: 'Pinned message is not found'\n  },\n  message_deleted: {\n    id: 'message_deleted',\n    defaultMessage: 'message deleted',\n    description: 'Pinned message is deleted'\n  }\n});\n\nclass PinnedMessages extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    // Starting location of the touch gesture.\n    this.touchX = null;\n    this.touchY = null;\n\n    this.touchSurface = React.createRef();\n\n    this.getSelectedIndex = this.getSelectedIndex.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n    this.handleSelected = this.handleSelected.bind(this);\n    this.handleMoveNext = this.handleMoveNext.bind(this);\n    this.handleMovePrev = this.handleMovePrev.bind(this);\n    this.handleTouchEventStart = this.handleTouchEventStart.bind(this);\n    this.handleTouchEventEnd = this.handleTouchEventEnd.bind(this);\n    this.handleTouchCancel = this.handleTouchCancel.bind(this);\n  }\n\n  componentDidMount() {\n    this.touchSurface.current.addEventListener('touchstart', this.handleTouchEventStart, {passive: true});\n    this.touchSurface.current.addEventListener('touchend', this.handleTouchEventEnd, {passive: true});\n    this.touchSurface.current.addEventListener('touchcancel', this.handleTouchCancel, {passive: true});\n  }\n\n  componentWillUnmount() {\n    this.touchSurface.current.removeEventListener('touchstart', this.handleTouchEventStart);\n    this.touchSurface.current.removeEventListener('touchend', this.handleTouchEventEnd);\n    this.touchSurface.current.removeEventListener('touchcancel', this.handleTouchCancel);\n  }\n  getSelectedIndex() {\n    const list = (this.props.pins || []);\n    return list.length - this.props.selected - 1;\n  }\n\n  handleCancel(e) {\n    e.preventDefault();\n    this.props.onCancel(this.props.pins[this.getSelectedIndex()]);\n  }\n\n  handleSelected(e) {\n    e.preventDefault();\n    this.props.onSelected(this.props.pins[this.getSelectedIndex()]);\n  }\n\n  handleMoveNext(e, isTouch) {\n    // Don't call preventDefault for touch events.\n    isTouch || e.preventDefault();\n    e.stopPropagation();\n    const idx = Math.max(this.props.selected - 1, 0);\n    if (idx != this.props.selected) {\n      this.props.setSelected(idx);\n    }\n  }\n\n  handleMovePrev(e, isTouch) {\n    // Don't call preventDefault for touch events.\n    isTouch || e.preventDefault();\n    e.stopPropagation();\n    const idx = Math.min(this.props.selected + 1, (this.props.pins || []).length - 1);\n    if (idx != this.props.selected) {\n      this.props.setSelected(idx);\n    }\n  }\n\n  handleTouchEventStart(e) {\n    if (e.touches.length == 1) {\n      this.touchX = e.touches[0].clientX;\n      this.touchY = e.touches[0].clientY;\n    }\n  }\n\n  handleTouchEventEnd(e) {\n    if (this.touchX === null || e.changedTouches.length != 1) {\n      this.touchX = null;\n      return;\n    }\n\n    const dX = this.touchX - e.changedTouches[0].clientX;\n    const dY = this.touchY - e.changedTouches[0].clientY;\n    this.touchX = null;\n\n    if (Math.abs(dX) > Math.abs(dY) || Math.abs(dY) < MIN_SWIPE_DISTANCE) {\n      // Horizontal swipe or too short vertical swipe.\n      return;\n    }\n\n    if (dY > 0) {\n      this.handleMovePrev(e, true);\n    } else {\n      this.handleMoveNext(e, true);\n    }\n  }\n\n  handleTouchCancel() {\n    this.touchX = null;\n  }\n\n  render() {\n    const selected = this.getSelectedIndex();\n    let messageShown = (this.props.messages || [])[selected];\n    messageShown = messageShown ?\n        messageShown._deleted ?\n        <i className=\"gray\">{this.props.intl.formatMessage(messages.message_deleted)}</i>\n        :\n        Drafty.format(messageShown.content, previewFormatter, {\n          formatMessage: this.props.intl.formatMessage.bind(this.props.intl),\n          authorizeURL: this.props.tinode.authorizeURL.bind(this.props.tinode)\n        })\n      :\n      <i className=\"gray\">{this.props.intl.formatMessage(messages.message_not_found)}</i>;\n\n    const dots = [];\n    this.props.pins.forEach(seq => {\n      const cn = dots.length == selected ? 'adot' : 'dot';\n      dots.push(<div key={seq} className={cn} />);\n    });\n\n    return (\n      <div id=\"pinned-wrapper\" ref={this.touchSurface}>\n        {this.props.isAdmin ?\n          <div className=\"cancel\">\n            <a href=\"#\" onClick={this.handleCancel}><i className=\"m-icon gray\">close</i></a>\n          </div> :\n          <div><i className=\"m-icon gray\">push_pin</i></div>\n        }\n        <div className=\"pinned-scroll\">{dots}</div>\n        <div className=\"pinned\" onClick={this.handleSelected}><p>{messageShown}</p></div>\n        <div className=\"pinned-menu\">\n          <span className=\"menuTrigger upper\">\n            {selected > 0 ?\n              <a href=\"#\" onClick={this.handleMovePrev}>\n                <i className=\"m-icon\">expand_less</i>\n              </a>\n              : null\n            }\n          </span>\n          <span className=\"menuTrigger lower\">\n            {this.props.selected > 0 ?\n              <a href=\"#\" onClick={this.handleMoveNext}>\n                <i className=\"m-icon\">expand_more</i>\n              </a>\n              : null\n            }\n          </span>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(PinnedMessages);\n","import React from 'react';\n\nimport { objectEqual } from '../lib/utils';\nimport CountBadge from './count-badge.jsx';\n\n// Number of emojis to show in collapsed panel.\nconst REACTIONS_COLLAPSED_COUNT = 6;\n// Maximum number of emojis to show in a panel (expanded).\nconst MAX_EMOJIS = 40;\n// Where to show the picker all else being equal: 'top', 'left', 'right', 'bottom'\nconst DISPLAY_PREFERENCE = 'top';\nconst PANEL_MARGIN = 8;\nconst TIP_SIZE = 7;\n// Width/height of the reaction-add button.\nconst BUTTON_SIZE = 14;\n// Distance from edge to tip point\nconst TIP_STOP = 12;\n// Right-side visible message bubble has a margin on the left.\nconst BUBBLE_MARGIN_LEFT = 23;\n\n// Compact emoji picker styled like Telegram/WhatsApp\n// Props:\n// - reactionList: array of emoji strings that can be used.\n// - anchor: { // Position of the click which launched the picker.\n//     offsetX: number, // X coordinate relative to message bubble.\n//     offsetY: number, // Y coordinate relative to message bubble.\n//     viewX: number,   // X coordinate relative to viewport\n//     viewY: number    // Y coordinate relative to viewport\n//   }\n// - viewportBounds: { width: number, height: number } size of the viewport\n// - onSelect: (emo) => void\n// - onClose: () => void\n// - dataTestPrefix: optional prefix for data-testid\nclass ReactionPicker extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      // position is an inline style object for the panel.\n      position: { marginLeft: '0', marginTop: '0' },\n      tipLeft: '12px',\n      placeAbove: 'top',\n      expanded: false\n    };\n    this.rootRef = React.createRef();\n    this.emojiRefs = [];\n    this.handleOutsideClick = this.handleOutsideClick.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.selectEmoji = this.selectEmoji.bind(this);\n    this.updatePosition = this.updatePosition.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.handleOutsideClick);\n    document.addEventListener('keydown', this.handleKeyDown);\n    // Focus first emoji for keyboard users\n    setTimeout(() => { if (this.emojiRefs[0]) this.emojiRefs[0].focus(); }, 0);\n    // Position picker so it's fully visible\n    this.updatePosition();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    // Reposition if anchor or viewportBounds changed or expanded state changed.\n    if (prevProps.anchor !== this.props.anchor ||\n        prevProps.viewportBounds !== this.props.viewportBounds ||\n        prevState.expanded !== this.state.expanded) {\n      // Use a timeout so DOM updates (expanded grid) are applied before measuring.\n      setTimeout(() => this.updatePosition(), 0);\n    }\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.handleOutsideClick);\n    document.removeEventListener('keydown', this.handleKeyDown);\n  }\n\n  handleOutsideClick(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    if (this.rootRef.current && !this.rootRef.current.contains(e.target)) {\n      this.props.onClose();\n    }\n  }\n\n  handleKeyDown(e) {\n    // Global handler only processes navigation keys when picker is open\n    if (e.key === 'Escape') {\n      this.props.onClose();\n      return;\n    }\n\n    const active = document.activeElement;\n    const idx = this.emojiRefs.findIndex(el => el === active);\n    if (e.key === 'ArrowRight') {\n      if (idx == -1) {\n        this.emojiRefs[0] && this.emojiRefs[0].focus();\n      } else {\n        const next = (idx + 1) % this.emojiRefs.length;\n        this.emojiRefs[next] && this.emojiRefs[next].focus();\n      }\n      e.preventDefault();\n    } else if (e.key === 'ArrowLeft') {\n      if (idx == -1) {\n        const last = this.emojiRefs.length - 1;\n        this.emojiRefs[last] && this.emojiRefs[last].focus();\n      } else {\n        const prev = (idx - 1 + this.emojiRefs.length) % this.emojiRefs.length;\n        this.emojiRefs[prev] && this.emojiRefs[prev].focus();\n      }\n      e.preventDefault();\n    } else if ((e.key === 'Enter' || e.key === ' ') && idx >= 0) {\n      const emojis = this.props.reactionList || [];\n      const emo = emojis[idx];\n      this.selectEmoji(emo);\n      e.preventDefault();\n    }\n  }\n\n  selectEmoji(emo) {\n    this.props.onSelect(emo);\n    this.props.onClose();\n  }\n\n  updatePosition() {\n    if (!this.rootRef.current) {\n      return;\n    }\n\n    const panelRect = this.rootRef.current.getBoundingClientRect();\n    const hSize = panelRect.width;\n    const vSize = panelRect.height;\n\n    // Choose maximum available space around click point to display the panel.\n    const spaceLeft = this.props.anchor.viewX - hSize - PANEL_MARGIN * 2 - TIP_SIZE - BUTTON_SIZE / 2;\n    const spaceRight = this.props.viewportBounds.width - this.props.anchor.viewX - hSize - PANEL_MARGIN * 2 - TIP_SIZE - BUTTON_SIZE / 2;\n    const spaceTop = this.props.anchor.viewY - vSize - PANEL_MARGIN * 2 - TIP_SIZE - BUTTON_SIZE / 2;\n    const spaceBottom = this.props.viewportBounds.height - this.props.anchor.viewY - vSize - PANEL_MARGIN * 2 - TIP_SIZE / 2 ;\n\n    const bubbleMargin = this.props.leftBubble ? 0 : BUBBLE_MARGIN_LEFT;\n    let preferred = DISPLAY_PREFERENCE;\n    let space = spaceTop;\n    if (space < 0 && space < spaceBottom) {\n      preferred = 'bottom';\n      space = spaceBottom;\n    }\n    if (space < 0 && space < spaceLeft) {\n      preferred = 'left';\n      space = spaceLeft;\n    }\n    if (space < 0 && space < spaceRight) {\n      preferred = 'right';\n      space = spaceRight;\n    }\n\n    // Calculate position so the panel is fully visible within the message view bounds.\n    let marginTop, marginLeft;\n    if (preferred == 'top' || preferred == 'bottom') {\n      // Place panel in such a way than anchor point is under/above the panel.\n      if (hSize > this.props.viewportBounds.width) {\n        // The panel wider than viewport: align to the exact middle.\n        marginLeft = (this.props.viewportBounds.width - hSize) / 2;\n      } else {\n        // Desired position if panel is fully visible:\n        // 1. if click point is on left side, place panel 1/3 to the left of the click point.\n        // 2. if click point is on right side, place panel 2/3 to the left of the click point.\n        // Then make sure panel is fully visible.\n        if (spaceRight > spaceLeft) {\n          // Clickpoint on left  of center (bubble is probably on the left).\n          // Margin space available to the left of click point, positive value.\n          const availableLeft = this.props.anchor.viewX - this.props.anchor.offsetX - PANEL_MARGIN;\n          // Preferred margin: 1/3 of panel width to the left of click point, could be negative.\n          const preferredX = this.props.anchor.offsetX - hSize * 0.33;\n          // Make sure panel is fully visible: availableLeft + offsetX > 0.\n          marginLeft = Math.max(-availableLeft, preferredX);\n        } else {\n          // Clickpoint on right of center (bubble is probably on the right).\n          // Preferred position: 2/3 of panel width to the left of click point, but make sure panel is fully visible.\n          const availableRight = this.props.viewportBounds.width - this.props.anchor.viewX - PANEL_MARGIN - BUTTON_SIZE / 2;\n          const offsetX = this.props.anchor.offsetX - hSize * 0.67;\n          marginLeft = offsetX + Math.min(0, bubbleMargin + availableRight - hSize * 0.33);\n        }\n      }\n      // Horizontal placement of tail: place close to click position.\n      this.setState({ tipLeft: Math.max(TIP_STOP, Math.min(hSize - TIP_STOP - TIP_SIZE * 2,\n        this.props.anchor.offsetX - marginLeft + bubbleMargin)) + 'px' });\n      // Fixed vertical positioning: above or below the button.\n      if (preferred == 'top') {\n        marginTop = this.props.anchor.offsetY - vSize - TIP_SIZE - PANEL_MARGIN;\n      } else {\n        marginTop = this.props.anchor.offsetY + TIP_SIZE + PANEL_MARGIN + BUTTON_SIZE;\n      }\n      marginTop = marginTop + 'px';\n      marginLeft = marginLeft + 'px';\n    } else {\n      // Left or right placement: panel is too tall to completely display above or below the anchor point.\n      if (preferred == 'left') {\n        marginLeft = this.props.anchor.offsetX - hSize - TIP_SIZE - PANEL_MARGIN + bubbleMargin;\n      } else { // right\n        marginLeft = this.props.anchor.offsetX + PANEL_MARGIN + TIP_SIZE + BUTTON_SIZE;\n      }\n      if (vSize > this.props.viewportBounds.height) {\n        // The panel is taller than viewport: align to the exact middle.\n        marginTop = (this.props.viewportBounds.height - vSize) / 2 - this.props.anchor.viewY;\n      } else {\n        // Click above or below center of viewport?\n        const above = this.props.viewportBounds.height / 2 > this.props.anchor.viewY;\n        if (above) {\n          // More space below the anchor point (message is close to top).\n          // Keep panel close to top.\n          marginTop = -this.props.anchor.viewY + this.props.anchor.offsetY + PANEL_MARGIN + BUTTON_SIZE / 2;\n        } else {\n          // More space above the anchor point (message is close to bottom).\n          // Keep panel close to top.\n          marginTop = spaceBottom - PANEL_MARGIN + this.props.anchor.offsetY + BUTTON_SIZE / 2;\n        }\n      }\n      // Vertical placement of tip: place close to the anchor position.\n      this.setState({ tipTop: Math.max(TIP_STOP, Math.min(vSize - TIP_STOP - TIP_SIZE * 2,\n         this.props.anchor.offsetY - marginTop)) + 'px' });\n      marginTop = marginTop + 'px';\n      marginLeft = marginLeft + 'px';\n    }\n\n    // Tail placement above or below the panel depends on whether panel is above or below click point.\n    this.setState({ placeAbove: preferred });\n\n    // Only update state if values changed to avoid rerenders: new object triggers rerender.\n    let newPos = { marginLeft: marginLeft, marginTop: marginTop };\n    if (!objectEqual(this.state.position, newPos)) {\n      this.setState({ position: newPos });\n    }\n  }\n\n  render() {\n    const prefix = this.props.dataTestPrefix || 'reaction-picker';\n    const style = { ...this.state.position };\n    if (this.state.placeAbove == 'top' || this.state.placeAbove == 'bottom') {\n      style['--tip-left'] = this.state.tipLeft;\n      style['--tip-top'] = 'unset';\n    } else {\n      style['--tip-left'] = 'unset';\n      style['--tip-top'] = this.state.tipTop;\n    }\n    return (\n      <div ref={this.rootRef}\n          className={`reaction-picker ${this.state.placeAbove}${this.state.expanded ? ' expanded' : ''} `}\n          role=\"dialog\" aria-label=\"emoji picker\" style={style}>\n        {(this.props.reactionList || [])\n            .slice(0, this.state.expanded ? MAX_EMOJIS : REACTIONS_COLLAPSED_COUNT)\n            .map((emo, i) => {\n              const applied = (this.props.reactions || []).find(r => r.val == emo);\n              const count = (applied && applied.count > 1) ? (applied.count | 0) : false;\n              const mine = applied && applied.users.includes(this.props.myUserId);\n              return <div\n                key={emo}\n                ref={el => this.emojiRefs[i] = el}\n                className={`reaction-picker-btn${mine ? ' mine' : applied ? ' applied' : ''}`}\n                data-testid={`${prefix}-${emo}`}\n                onClick={() => { this.selectEmoji(emo); }}\n                onKeyDown={(e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); this.selectEmoji(emo); } }}\n                role=\"button\"\n                tabIndex={0}\n                aria-label={`react ${emo}`}>\n                {emo}\n                {count && <CountBadge rect={true} count={count} size=\"medium\"\n                  style={{ position: 'absolute', right: '-2px',bottom: '-2px' }} />\n                }\n              </div>;\n        })}\n        {(!this.state.expanded && (this.props.reactionList || []).length > REACTIONS_COLLAPSED_COUNT) &&\n          <>\n          <div className=\"divider\"/>\n          <div className=\"reaction-picker-btn\" role=\"button\" data-testid=\"reaction-expand\"\n              onClick={() => this.setState({expanded: true}, () => this.updatePosition())}>\n            <i className=\"m-icon\">expand_more</i>\n          </div>\n          </>}\n      </div>\n    );\n  }\n}\n\nexport default ReactionPicker;\n","import React from 'react';\n\nimport { shortenCount } from '../lib/strformat';\n\nclass ReactionStrip extends React.PureComponent {\n  render() {\n    const more = this.props.reactions.length - this.props.maxReactions;\n    return (\n      <div className=\"reactions\">\n        {/* Invisible zero-width element to prevent layout shift */}\n        <div style={{opacity:0, userSelect: 'none', width: '0.01rem'}}>0</div>\n        {this.props.reactions.slice(0, this.props.maxReactions).map(r => {\n          const you = r.users && this.props.myUserId && r.users.includes(this.props.myUserId);\n          return (\n            <div key={r.val}\n              data-testid={`reaction-${r.val}`}\n              className={'reaction' + (you ? ' active' : '')}\n              onClick={(e) => this.props.onReactionSelected(e, r.val)}>\n              <span className=\"emoji\">{r.val}</span>\n              {r.count > 1 && <span className=\"count\">{shortenCount(r.count)}</span>}\n            </div>\n          );\n        })}\n        <div className={`reaction-add${(this.props.pickerShown || more > 0) ? ' active' : ''}`}\n          data-testid=\"reaction-add\"\n          onMouseDown={(e) => { e.stopPropagation(); }}\n          onClick={this.props.onTogglePicker}>\n            <i className=\"m-icon\">{more > 0 ? 'more_horiz' : 'thumb_up_off_alt'}</i>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ReactionStrip;\n","// Received/read indicator.\nimport React from 'react';\nimport { defineMessages, injectIntl } from 'react-intl';\n\nimport { Tinode } from 'tinode-sdk';\n\nimport { deliveryMarker } from '../lib/utils.js';\n\nconst messages = defineMessages({\n  message_sending: {\n    id: 'message_sending',\n    defaultMessage: 'sending...',\n    description: 'Message being sent, in place of time stamp'\n  },\n  message_sending_failed: {\n    id: 'message_sending_failed',\n    defaultMessage: 'failed',\n    description: 'Failed to send message, in place of time stamp'\n  },\n  message_edited_marker: {\n    id: 'message_edited_marker',\n    defaultMessage: ', edited',\n    description: 'Marker indicating that the message was edited'\n  }\n});\n\nclass ReceivedMarker extends React.PureComponent {\n  render() {\n    const {formatMessage} = this.props.intl;\n    let timestamp;\n    if (this.props.received <= Tinode.MESSAGE_STATUS_SENDING) {\n      timestamp = formatMessage(messages.message_sending);\n    } else if (this.props.received == Tinode.MESSAGE_STATUS_FAILED ||\n        this.props.received == Tinode.MESSAGE_STATUS_FATAL) {\n      timestamp = formatMessage(messages.message_sending_failed);\n    } else {\n      timestamp = this.props.timestamp.toLocaleTimeString(this.props.intl.locale, { timeStyle: 'short' });\n    }\n\n    const icon = deliveryMarker(this.props.received);\n    const marker = icon ? <i className={'m-icon small ' + icon.color}>{icon.name}</i> : null;\n    const edited = this.props.edited ? formatMessage(messages.message_edited_marker) : null;\n\n    return (\n      <span className=\"timestamp\" style={this.props.style}>\n        {timestamp}{edited}{'\\u00a0'}{marker}\n      </span>\n    );\n  }\n};\n\nexport default injectIntl(ReceivedMarker);\n","// Send message form.\nimport React, { Suspense } from 'react';\nimport { FormattedMessage, defineMessages, injectIntl } from 'react-intl';\nimport { Drafty } from 'tinode-sdk';\n\n// Lazy-loading AudioRecorder because it's quite large due to\n// a dependency on webm-duration-fix.\nconst AudioRecorder = React.lazy(_ => import('./audio-recorder.jsx'));\n\nimport { KEYPRESS_DELAY } from '../config.js';\nimport { filePasted } from '../lib/blob-helpers.js';\nimport { replyFormatter } from '../lib/formatters.js';\n\nconst messages = defineMessages({\n  messaging_disabled: {\n    id: 'messaging_disabled_prompt',\n    defaultMessage: 'Messaging disabled',\n    description: 'Prompt in SendMessage in read-only topic'\n  },\n  type_new_message: {\n    id: 'new_message_prompt',\n    defaultMessage: 'New message',\n    description: 'Prompt in send message field'\n  },\n  add_image_caption: {\n    id: 'image_caption_prompt',\n    defaultMessage: 'Image caption',\n    description: 'Prompt in SendMessage for attached image'\n  },\n  file_attachment_too_large: {\n    id: 'file_attachment_too_large',\n    defaultMessage: 'The file size {size} exceeds the {limit} limit.',\n    description: 'Error message when attachment is too large'\n  },\n  cannot_initiate_upload: {\n    id: 'cannot_initiate_file_upload',\n    defaultMessage: 'Cannot initiate file upload.',\n    description: 'Generic error messagewhen attachment fails'\n  },\n  icon_title_record_voice: {\n    id: 'icon_title_record_voice',\n    defaultMessage: 'Record voice message',\n    description: 'Icon tool tip for recording a voice message'\n  },\n  icon_title_attach_file: {\n    id: 'icon_title_attach_file',\n    defaultMessage: 'Attach file',\n    description: 'Icon tool tip for attaching a file'\n  },\n  icon_title_add_image: {\n    id: 'icon_title_add_image',\n    defaultMessage: 'Add image',\n    description: 'Icon tool tip for attaching an image'\n  },\n  icon_title_send: {\n    id: 'icon_title_send',\n    defaultMessage: 'Send message',\n    description: 'Icon tool tip for sending a message'\n  },\n});\n\nclass SendMessage extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      quote: null,\n      message: '',\n      audioRec: false,\n      audioAvailable: !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia),\n    };\n\n    // Timestamp when the previous key press was sent to the server.\n    this.keypressTimestamp = 0;\n\n    this.handlePasteEvent = this.handlePasteEvent.bind(this);\n    this.handleAttachImage = this.handleAttachImage.bind(this);\n    this.handleAttachFile = this.handleAttachFile.bind(this);\n    this.handleAttachAudio = this.handleAttachAudio.bind(this);\n    this.handleSend = this.handleSend.bind(this);\n    this.handleKeyPress = this.handleKeyPress.bind(this);\n    this.handleMessageTyping = this.handleMessageTyping.bind(this);\n    this.handleDropAttach = this.handleDropAttach.bind(this);\n\n    this.handleQuoteClick = this.handleQuoteClick.bind(this);\n\n    this.formatReply = this.formatReply.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.messageEditArea) {\n      this.messageEditArea.addEventListener('paste', this.handlePasteEvent, false);\n      if (window.getComputedStyle(this.messageEditArea).getPropertyValue('transition-property') == 'all') {\n        // Set focus on desktop, but not on mobile: focus causes soft keyboard to pop up.\n        this.messageEditArea.focus();\n      }\n    }\n\n    this.setState({quote: this.formatReply()});\n  }\n\n  componentWillUnmount() {\n    if (this.messageEditArea) {\n      this.messageEditArea.removeEventListener('paste', this.handlePasteEvent, false);\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.messageEditArea) {\n      if (window.getComputedStyle(this.messageEditArea).getPropertyValue('transition-property') == 'all') {\n        // Set focus on desktop, but not on mobile: focus causes soft keyboard to pop up.\n        this.messageEditArea.focus();\n      }\n\n      // Adjust height of the message area for the amount of text.\n      this.messageEditArea.style.height = '0px';\n      this.messageEditArea.style.height = this.messageEditArea.scrollHeight + 'px';\n    }\n\n    if (prevProps.topicName != this.props.topicName) {\n      this.setState({message: this.props.initMessage || '', audioRec: false, quote: null});\n    } else if (prevProps.initMessage != this.props.initMessage) {\n      const msg = this.props.initMessage || '';\n      this.setState({message: msg}, _ => {\n        // If there is text, scroll to bottom and set caret to the end.\n        this.messageEditArea.scrollTop = this.messageEditArea.scrollHeight;\n        this.messageEditArea.setSelectionRange(msg.length, msg.length);\n      });\n    }\n    if (prevProps.reply != this.props.reply) {\n      this.setState({quote: this.formatReply()});\n    }\n  }\n\n  formatReply() {\n    return this.props.reply ?\n      Drafty.format(this.props.reply.content, replyFormatter, {\n        formatMessage: this.props.intl.formatMessage.bind(this.props.intl),\n        authorizeURL: this.props.tinode.authorizeURL.bind(this.props.tinode)\n      }) : null;\n  }\n\n  handlePasteEvent(e) {\n    if (this.props.disabled) {\n      return;\n    }\n    // FIXME: handle large files too.\n    if (filePasted(e,\n      file => { this.props.onAttachImage(file); },\n      file => { this.props.onAttachFile(file); },\n      this.props.onError)) {\n\n      // If a file was pasted, don't paste base64 data into input field.\n      e.preventDefault();\n    }\n  }\n\n  handleAttachImage(e) {\n    if (e.target.files && e.target.files.length > 0) {\n      this.props.onAttachImage(e.target.files[0]);\n    }\n    // Clear the value so the same file can be uploaded again.\n    e.target.value = '';\n  }\n\n  handleAttachFile(e) {\n    if (e.target.files && e.target.files.length > 0) {\n      this.props.onAttachFile(e.target.files[0]);\n    }\n    // Clear the value so the same file can be uploaded again.\n    e.target.value = '';\n  }\n\n  handleDropAttach(files) {\n    if (files && files.length > 0) {\n      this.props.onAttachFile(files[0]);\n    }\n  }\n\n  handleAttachAudio(url, preview, duration) {\n    this.setState({audioRec: false});\n    this.props.onAttachAudio(url, preview, duration);\n  }\n\n  handleSend(e) {\n    e.preventDefault();\n    const message = this.state.message.trim();\n    if (message || this.props.acceptBlank || this.props.noInput) {\n      this.props.onSendMessage(message);\n      this.setState({message: ''});\n    }\n  }\n\n  /* Send on Enter key */\n  handleKeyPress(e) {\n    if (this.state.audioRec) {\n      // Ignore key presses while audio is being recorded.\n      e.preventDefault();\n      e.stopPropagation();\n      return;\n    }\n\n    // Enter pressed: either send, or enter a new line.\n    if (e.key === 'Enter') {\n      if (this.props.sendOnEnter == 'plain') {\n        // Have Shift-Enter insert a line break instead\n        if (!e.shiftKey) {\n          e.preventDefault();\n          e.stopPropagation();\n\n          this.handleSend(e);\n        }\n      } else {\n        if (e.ctrlKey || e.metaKey) {\n          e.preventDefault();\n          e.stopPropagation();\n\n          this.handleSend(e);\n        }\n      }\n    }\n  }\n\n  handleMessageTyping(e) {\n    this.setState({message: e.target.value});\n    if (this.props.onKeyPress) {\n      const now = new Date().getTime();\n      if (now - this.keypressTimestamp > KEYPRESS_DELAY) {\n        this.props.onKeyPress();\n        this.keypressTimestamp = now;\n      }\n    }\n  }\n\n  handleQuoteClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (this.props.reply && this.props.onQuoteClick) {\n      const replyToSeq = this.props.reply.seq;\n      this.props.onQuoteClick(replyToSeq);\n    }\n  }\n\n  render() {\n    const { formatMessage } = this.props.intl;\n    const prompt = this.props.disabled ?\n      formatMessage(messages.messaging_disabled) :\n      (this.props.messagePrompt ?\n        formatMessage(messages[this.props.messagePrompt]) :\n        formatMessage(messages.type_new_message));\n\n    const sendIcon = (this.props.reply && this.props.reply.editing) ?\n      'check_circle' : 'send';\n\n    const quote = this.state.quote ?\n      (<div id=\"reply-quote-preview\">\n        <div className=\"cancel\">\n          <a href=\"#\" onClick={e => {e.preventDefault(); this.props.onCancelReply();}}><i className=\"m-icon gray\">close</i></a>\n        </div>\n        {this.state.quote}\n      </div>) : null;\n    const audioEnabled = this.state.audioAvailable && this.props.onAttachAudio;\n    return (\n      <div id=\"send-message-wrapper\">\n        {!this.props.noInput ? quote : null}\n        <div id=\"send-message-panel\">\n          {!this.props.disabled ?\n            <>\n              {this.props.onAttachFile && !this.state.audioRec ?\n                <>\n                  <a href=\"#\" onClick={e => {e.preventDefault(); this.attachImage.click();}} title={formatMessage(messages.icon_title_add_image)}>\n                    <i className=\"m-icon secondary\">photo</i>\n                  </a>\n                  <a href=\"#\" onClick={e => {e.preventDefault(); this.attachFile.click();}} title={formatMessage(messages.icon_title_attach_file)}>\n                    <i className=\"m-icon secondary\">attach_file</i>\n                  </a>\n                </>\n                :\n                null}\n              {this.props.noInput ?\n                (quote || <div className=\"hr thin\" />) :\n                (this.state.audioRec ?\n                  (<Suspense fallback={<div><FormattedMessage id=\"loading_note\" defaultMessage=\"Loading...\"\n                  description=\"Message shown when component is loading\"/></div>}>\n                    <AudioRecorder\n                      onRecordingProgress={_ => this.props.onKeyPress(true)}\n                      onDeleted={_ => this.setState({audioRec: false})}\n                      onFinished={this.handleAttachAudio}/>\n                  </Suspense>) :\n                  <textarea id=\"send-message-input\" placeholder={prompt}\n                    value={this.state.message} onChange={this.handleMessageTyping}\n                    onKeyDown={this.handleKeyPress}\n                    ref={ref => {this.messageEditArea = ref;}} />)}\n              {this.state.message || !audioEnabled ?\n                <a href=\"#\" onClick={this.handleSend} title={formatMessage(messages.icon_title_send)}>\n                  <i className=\"m-icon fill\">{sendIcon}</i>\n                </a> :\n                !this.state.audioRec ?\n                  <a href=\"#\" onClick={e => {e.preventDefault(); this.setState({audioRec: true})}} title={formatMessage(messages.icon_title_record_voice)}>\n                    <i className=\"m-icon fill\">mic</i>\n                  </a> :\n                  null\n              }\n              <input type=\"file\" ref={ref => {this.attachFile = ref}}\n                onChange={this.handleAttachFile} style={{display: 'none'}} />\n              <input type=\"file\" ref={ref => {this.attachImage = ref}} accept=\"image/*, video/*\"\n                onChange={this.handleAttachImage} style={{display: 'none'}} />\n            </>\n            :\n            <div id=\"writing-disabled\">{prompt}</div>\n          }\n        </div>\n      </div>\n    );\n  }\n};\n\nexport default injectIntl(SendMessage);\n"],"names":["React","FormattedMessage","Tinode","APP_NAME","LogoView","PureComponent","render","version","getLibrary","createElement","id","href","alt","src","defaultMessage","props","serverVersion","serverAddress","Suspense","defineMessages","injectIntl","Drafty","TheCard","CallPanel","lazy","_","ChatMessage","ContactBadges","DocPreview","ErrorPanel","GroupSubs","ImagePreview","Invitation","LetterTile","LoadSpinner","MetaMessage","PinnedMessages","SendMessage","TheCardPreview","VideoPreview","DEFAULT_P2P_ACCESS_MODE","EDIT_PREVIEW_LENGTH","IMAGE_PREVIEW_DIM","IMMEDIATE_P2P_SUBSCRIPTION","DRAFTY_FR_MIME_TYPE_LEGACY","KEYPRESS_DELAY","MESSAGES_PAGE","MAX_EXTERN_ATTACHMENT_SIZE","MAX_IMAGE_DIM","MAX_INBAND_ATTACHMENT_SIZE","READ_DELAY","QUOTED_REPLY_LENGTH","VIDEO_PREVIEW_DIM","CALL_STATE_OUTGOING_INITATED","CALL_STATE_IN_PROGRESS","blobToBase64","fileToBase64","imageScaled","importVCard","makeImageUrl","HashNavigation","bytesToHumanSize","relativeDateFormat","shortDateFormat","NOTIFICATION_EXEC_INTERVAL","SHOW_GO_TO_LAST_DIST","FETCH_PAGE_TRIGGER","messages","online_now","last_seen","not_found","channel","file_attachment_too_large","invalid_content","editing_message","drag_file","self_topic_name","subscriber_count","member_count","cannot_parse_vcard","isUnconfirmed","acs","ex","getExcessive","isJoiner","includes","isPeerRestricted","ms","getMissing","shouldPresentCallPanel","callState","MessagesView","Component","constructor","state","getDerivedStateFromProps","componentSetup","bind","leave","sendMessage","retrySend","sendImageAttachment","sendVideoAttachment","sendFileAttachment","sendAudioAttachment","sendTheCardAttachment","sendKeyPress","subscribe","handleScrollReference","mountComponentEvents","handleScrollEvent","handleDescChange","handleSubsUpdated","handleMessageUpdate","handleReactUpdate","handleAuxUpdate","handleAllMessagesReceived","handleInfoReceipt","handleExpandMedia","handleClosePreview","handleCallPanelToggle","handleFormResponse","handleContextClick","handleShowMessageContextMenu","handleNewChatAcceptance","handleEnablePeer","handleAttachFile","handleAttachImageOrVideo","handleCancelUpload","postReadNotification","clearNotificationQueue","goToLatestMessage","handleFileDrop","handlePickReply","handleEditMessage","handleCancelReply","handleQuoteClick","handleUnpinMessage","handleCallHangup","isDragEnabled","handleReact","handleToggleReactionPicker","handleDragStart","handleDragIn","handleDragOut","handleDrag","handleDrop","chatMessageRefs","getOrCreateMessageRef","getVisibleMessageRange","dragCounter","componentRef","readNotificationQueue","readNotificationTimer","keyPressTimer","seqId","ref","createRef","holderRect","min","Number","MAX_SAFE_INTEGER","max","visibilityStatus","every","seq","current","top","bottom","height","getBoundingClientRect","visible","Math","componentDidMount","messagesScroller","addEventListener","componentWillUnmount","removeEventListener","componentDidUpdate","prevProps","prevState","topic","maxSeqId","minSeqId","scrollPosition","scrollTop","scrollHeight","offsetHeight","applicationVisible","tinode","getTopic","undefined","isNewGroupTopicName","rtcPanel","callSeq","onData","onAllMessagesReceived","onInfo","onMetaDesc","onSubsUpdated","onPres","onAuxUpdated","onReact","myUserId","newTopic","newTopicParams","_topicName","isP2PType","getMeta","startMetaQuery","withDesc","build","isSubscribed","isReader","withLaterData","nextProps","nextState","latestClearId","onlineSubs","title","avatar","isVerified","isStaff","isDangerous","deleted","docPreview","imagePreview","imagePostview","videoPreview","videoPostview","minimizedCallPanel","typingIndicator","fetchingMessages","peerMessagingDisabled","reply","contentToEdit","showGoToLastButton","dragging","pins","pinsLoaded","selectedPin","subsVersion","reactionPickerShownFor","reactionList","maxReactions","forwardMessage","content","size","length","object","type","preview","_deleted","subs","connected","subscribers","sub","online","user","push","Object","assign","isSelfType","intl","formatMessage","public","fn","photo","peer","p2pPeerDesc","minMsgSeq","maxMsgSeq","maxClearId","isChannelType","aux","slice","callTopic","name","reactions","isWriter","isAdmin","readingBlocked","isSharer","unconformed","unconfirmed","ready","getQuery","withLaterDesc","withLaterSub","withAux","withLaterDel","setState","setQuery","then","ctrl","code","navigateTo","setUrlTopic","params","onNewTopicCreated","discard","queuedMessages","pub","_sending","_fatal","head","webrtc","delMessagesList","catch","err","console","error","onError","message","blankState","oldTopicName","isTopicCached","oldTopic","finally","node","event","pos","target","processingScrollEvent","gaps","msgHasMoreMessages","getMessagesPage","desc","isSelfTopicName","setInterval","markReactionsSeen","clearInterval","n","topicName","shift","now","Date","sendAt","isServerAssignedSeq","noteRead","setMilliseconds","getMilliseconds","newState","msg","clearTimeout","isNewMessage","status","msgStatus","MESSAGE_STATUS_SENT","from","seqIds","forceUpdate","emo","react","count","getPinnedMessages","info","what","setTimeout","video","url","URL","revokeObjectURL","onCancelForwardMessage","action","text","data","attachJSON","parse","searchParams","key","resp","hasOwnProperty","set","forEach","search","window","open","e","preventDefault","stopPropagation","showContextMenu","y","pageY","x","pageX","messageSpecificMenuItems","userFrom","userName","menuItems","getAccessMode","isDeleter","canDelete","isOwner","maxDelAge","getServerParam","MSG_DELETE_AGE","timestamp","getTime","onNewChat","onChangePermissions","audio","noteRecording","noteKeyPress","uploadCompletionPromise","uploader","editing","replace","append","sanitizeEntities","file","maxInbandAttachmentSize","isFileSupported","contentType","jsonMimeConverter","fileType","getLargeFileHelper","cannot_initiate_upload","upload","attachFile","mime","filename","urlPromise","b64","bits","appendTheCard","card","maxExternAttachmentSize","limit","onVideoCallClosed","onCallHangup","caption","blob","width","fname","scaled","insertImage","_tempPreview","appendLineBreak","videoBlob","previewBlob","uploads","Promise","all","b64s","v64","i64","insertVideo","premime","duration","b64conv","img","startsWith","createObjectURL","files","fetch","result","appendAudio","found","findMessage","_cancelled","cancel","senderId","senderName","init","isValid","replyContent","wrapInto","quote","editable","toMarkdown","replyToSeq","scrollIntoView","block","behavior","classList","add","remove","pinMessage","dataTransfer","clearData","items","overlay","fallback","callAudioOnly","minimized","onHangup","onToggleMinimize","onInvite","onCallInvite","onSendOffer","onCallSendOffer","onIceCandidate","onCallIceCandidate","onSendAnswer","onCallSendAnswer","component","component2","onCancelReply","onClose","onSendMessage","isChannel","chan","groupTopic","isGroupType","icon_badges","trusted","verified","icon","color","staff","danger","pinnedMessages","latestMsgVersion","messageNodes","previousFrom","prevDate","chatBoxClass","prev","next","i","nextFrom","sequence","thisFrom","isReply","deliveryStatus","userAvatar","userDesc","parseInt","isNaN","hi","thisDate","ts","toDateString","date","locale","mimeType","edited","response","isGroup","isChan","received","_uploader","userIsWriter","userIsAdmin","showPicker","pinned","viewportWidth","msgReactions","onExpandMedia","onFormResponse","onCancelUpload","pickReply","editMessage","onQuoteClick","onAcceptCall","onToggleReactionPicker","parentRef","lastSeen","subcnt","cont","getMeTopic","getContact","isP2PTopicName","seen","when","isGroupTopicName","titleClass","darkModeClass","colorSchema","messagesComponent","Fragment","className","onClick","onAction","noInput","disabled","initMessage","sendOnEnter","onKeyPress","onRecordingProgress","onAttachFile","onAttachImage","onAttachAudio","displayMobile","onHideMessagesView","authorizeURL","badges","style","marginLeft","selected","setSelected","index","onSelected","onCancel","level","errorLevel","errorText","onClearError","show","UnwrappedMessagesView","FileProgress","isUrlRelative","sanitizeUrl","Attachment","downloader","progress","downloadFile","handleCancel","mimetype","download","loaded","uploading","substr","helperFunc","downloadUrl","downloadWidget","ReactionStrip","ReceivedMarker","fullFormatter","ReactionPicker","BaseChatMessage","onProgress","handleProgress","handleExpandImage","handlePlayVideo","handleFormButtonClick","handleTogglePicker","handleReactionSelected","handleDraftyClick","formatterContext","onHandleClick","pathname","dataset","val","parts","split","filter","Boolean","pop","hashUrl","setUrlSidePanel","location","hash","addUrlParam","act","MESSAGE_STATUS_FAILED","MESSAGE_STATUS_FATAL","immutable","entities","_0","_1","tp","styles","ratio","parentRect","buttonRect","pickerAnchor","viewX","left","viewY","offsetX","offsetLeft","offsetY","offsetTop","parentBounds","right","sideClass","bubbleClass","textSizeClass","fullDisplay","attachments","getContentType","att","isFormResponseType","getDownloadUrl","isProcessing","getEntitySize","tree","format","RegExp","test","match","innerRef","pickerShown","onTogglePicker","onReactionSelected","marginBottom","leftBubble","anchor","viewportBounds","onSelect","dataTestPrefix","IntlChatMessage","forwardRef","_extends","MAX_ONLINE_IN_TOPIC","usersOnline","totalCount","countToShow","some","values","overflow","handleButtonAction","evt","previewFormatter","MIN_SWIPE_DISTANCE","message_not_found","message_deleted","touchX","touchY","touchSurface","getSelectedIndex","handleSelected","handleMoveNext","handleMovePrev","handleTouchEventStart","handleTouchEventEnd","handleTouchCancel","passive","list","isTouch","idx","touches","clientX","clientY","changedTouches","dX","dY","abs","messageShown","dots","cn","objectEqual","CountBadge","REACTIONS_COLLAPSED_COUNT","MAX_EMOJIS","DISPLAY_PREFERENCE","PANEL_MARGIN","TIP_SIZE","BUTTON_SIZE","TIP_STOP","BUBBLE_MARGIN_LEFT","position","marginTop","tipLeft","placeAbove","expanded","rootRef","emojiRefs","handleOutsideClick","handleKeyDown","selectEmoji","updatePosition","document","focus","contains","active","activeElement","findIndex","el","last","emojis","panelRect","hSize","vSize","spaceLeft","spaceRight","spaceTop","spaceBottom","bubbleMargin","preferred","space","availableLeft","preferredX","availableRight","above","tipTop","newPos","prefix","role","map","applied","find","r","mine","users","onKeyDown","tabIndex","rect","shortenCount","more","opacity","userSelect","you","onMouseDown","deliveryMarker","message_sending","message_sending_failed","message_edited_marker","MESSAGE_STATUS_SENDING","toLocaleTimeString","timeStyle","marker","AudioRecorder","filePasted","replyFormatter","messaging_disabled","type_new_message","add_image_caption","icon_title_record_voice","icon_title_attach_file","icon_title_add_image","icon_title_send","audioRec","audioAvailable","navigator","mediaDevices","getUserMedia","keypressTimestamp","handlePasteEvent","handleAttachImage","handleAttachAudio","handleSend","handleKeyPress","handleMessageTyping","handleDropAttach","formatReply","messageEditArea","getComputedStyle","getPropertyValue","setSelectionRange","value","trim","acceptBlank","shiftKey","ctrlKey","metaKey","prompt","messagePrompt","sendIcon","audioEnabled","attachImage","click","onDeleted","onFinished","placeholder","onChange","display","accept"],"ignoreList":[],"sourceRoot":""}