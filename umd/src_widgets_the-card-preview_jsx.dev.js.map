{"version":3,"file":"src_widgets_the-card-preview_jsx.dev.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;AAA0B;AACoC;AACF;AAEf;AACF;AAEN;AACgB;AAErD,MAAMQ,QAAQ,GAAGP,0DAAc,CAAC;EAC9BQ,YAAY,EAAE;IACZC,EAAE,gBAAgB;IAClBC,cAAc;MAAA;MAAA;IAAA;EAEhB;AACF,CAAC,CAAC;AAEa,MAAMC,cAAc,SAASZ,4DAAmB,CAAC;EAC9Dc,WAAWA,CAACC,KAAK,EAAE;IACjB,KAAK,CAACA,KAAK,CAAC;IAEZ,IAAI,CAACC,KAAK,GAAG;MACXC,OAAO,EAAEF,KAAK,CAACE,OAAO,CAACC;IACzB,CAAC;IAED,IAAI,CAACH,KAAK,CAACE,OAAO,CAACC,MAAM,EAAE;MACzBX,iEAAW,CAACQ,KAAK,CAACE,OAAO,CAACE,IAAI,CAAC,CAC5BC,IAAI,CAACC,IAAI,IAAI;QACZ,IAAI,CAACC,QAAQ,CAAC;UAAEL,OAAO,EAAEI;QAAK,CAAC,CAAC;MAClC,CAAC,CAAC;IACN;IAEA,IAAI,CAACE,cAAc,GAAG,IAAI,CAACA,cAAc,CAACC,IAAI,CAAC,IAAI,CAAC;IACpD,IAAI,CAACC,aAAa,GAAG,IAAI,CAACA,aAAa,CAACD,IAAI,CAAC,IAAI,CAAC;EACpD;EAEAE,iBAAiBA,CAAA,EAAG;IAClBC,QAAQ,CAACC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAACH,aAAa,CAAC;EAC1D;EAEAI,oBAAoBA,CAAA,EAAG;IACrBF,QAAQ,CAACG,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAACL,aAAa,CAAC;EAC7D;EAEAA,aAAaA,CAACM,CAAC,EAAE;IACfA,CAAC,CAACC,cAAc,CAAC,CAAC;IAClB,IAAID,CAAC,CAACE,GAAG,KAAK,QAAQ,EAAE;MACtB,IAAI,CAAClB,KAAK,CAACmB,OAAO,CAAC,CAAC;IACtB;EACF;EAEAX,cAAcA,CAAA,EAAG;IACf,IAAI,CAACR,KAAK,CAACmB,OAAO,CAAC,CAAC;IACpB,IAAI,CAACnB,KAAK,CAACoB,aAAa,CAAC,IAAI,CAACpB,KAAK,CAACE,OAAO,CAAC;EAC9C;EAEAmB,MAAMA,CAAA,EAAG;IACP,MAAMf,IAAI,GAAG,IAAI,CAACL,KAAK,CAACC,OAAO;IAE/B,MAAMoB,QAAQ,GAAG/B,+CAAO,CAACgC,KAAK,CAACjB,IAAI,CAAC;IACpC,MAAMkB,QAAQ,GAAGjC,+CAAO,CAACkC,WAAW,CAACnB,IAAI,CAAC,IAAI,IAAI;IAClD,MAAMoB,IAAI,GAAGpB,IAAI,EAAEoB,IAAI;IACvB,MAAMC,GAAG,GAAGpC,+CAAO,CAACqC,MAAM,CAACtB,IAAI,CAAC;IAGhC,MAAMuB,MAAM,GAAGtC,+CAAO,CAACuC,OAAO,CAACxB,IAAI,EAAE,OAAO,CAAC,IAAI,EAAE;IACnD,MAAMyB,MAAM,GAAGxC,+CAAO,CAACuC,OAAO,CAACxB,IAAI,EAAE,KAAK,CAAC,IAAI,EAAE;IACjD,MAAM0B,SAAS,GAAGzC,+CAAO,CAACuC,OAAO,CAACxB,IAAI,EAAE,QAAQ,CAAC,IAAI,EAAE;IACvD,MAAM2B,IAAI,GAAG1C,+CAAO,CAACuC,OAAO,CAACxB,IAAI,EAAE,MAAM,CAAC,IAAI,EAAE;IAEhD,MAAM4B,QAAQ,GAAG,EAAE;IAGnBL,MAAM,CAACM,OAAO,CAAC,CAACC,KAAK,EAAEC,GAAG,KAAK;MAC7B,MAAMC,KAAK,GAAGC,KAAK,CAACC,OAAO,CAACJ,KAAK,CAACK,GAAG,CAAC,GAAGL,KAAK,CAACK,GAAG,CAACC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;MAClER,QAAQ,CAACS,IAAI,CACX1D,0DAAA;QAAK4D,SAAS,EAAC,cAAc;QAAC3B,GAAG,EAAE,SAASmB,GAAG;MAAG,GAChDpD,0DAAA,aAAKmD,KAAK,CAACU,KAAU,CAAC,EACtB7D,0DAAA;QAAM4D,SAAS,EAAC;MAAY,GAAC,GAAC,EAACP,KAAK,GAAG,IAAIA,KAAK,GAAG,GAAG,EAAS,CAC5D,CACP,CAAC;IACH,CAAC,CAAC;IAGFP,MAAM,CAACI,OAAO,CAAC,CAACY,KAAK,EAAEV,GAAG,KAAK;MAC7B,IAAIW,GAAG,GAAGD,KAAK,CAACD,KAAK;MACrB,IAAI;QACF,MAAMG,MAAM,GAAG7D,mFAAgB,CAAC2D,KAAK,CAACD,KAAK,CAAC;QAC5CE,GAAG,GAAGC,MAAM,GAAGA,MAAM,CAACC,mBAAmB,CAAC,CAAC,GAAGH,KAAK,CAACD,KAAK;MAC3D,CAAC,CAAC,OAAOK,GAAG,EAAE,CAEd;MACA,MAAMb,KAAK,GAAGC,KAAK,CAACC,OAAO,CAACO,KAAK,CAACN,GAAG,CAAC,GAAGM,KAAK,CAACN,GAAG,CAACC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;MAClER,QAAQ,CAACS,IAAI,CACX1D,0DAAA;QAAK4D,SAAS,EAAC,cAAc;QAAC3B,GAAG,EAAE,OAAOmB,GAAG;MAAG,GAC9CpD,0DAAA,aAAK+D,GAAQ,CAAC,EACd/D,0DAAA;QAAM4D,SAAS,EAAC;MAAY,GAAC,GAAC,EAACP,KAAK,GAAG,IAAIA,KAAK,GAAG,GAAG,EAAS,CAC5D,CACP,CAAC;IACH,CAAC,CAAC;IAGFN,SAAS,CAACG,OAAO,CAAC,CAACiB,GAAG,EAAEf,GAAG,KAAK;MAC9B,MAAMC,KAAK,GAAGC,KAAK,CAACC,OAAO,CAACY,GAAG,CAACX,GAAG,CAAC,GAAGW,GAAG,CAACX,GAAG,CAACC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;MAC9DR,QAAQ,CAACS,IAAI,CACX1D,0DAAA;QAAK4D,SAAS,EAAC,cAAc;QAAC3B,GAAG,EAAE,UAAUmB,GAAG;MAAG,GACjDpD,0DAAA,aAAKmE,GAAG,CAACN,KAAU,CAAC,EACpB7D,0DAAA;QAAM4D,SAAS,EAAC;MAAY,GAAC,GAAC,EAACP,KAAK,GAAG,IAAIA,KAAK,GAAG,GAAG,EAAS,CAC5D,CACP,CAAC;IACH,CAAC,CAAC;IAGFL,IAAI,CAACE,OAAO,CAAC,CAACkB,GAAG,EAAEhB,GAAG,KAAK;MACzB,MAAMC,KAAK,GAAGC,KAAK,CAACC,OAAO,CAACa,GAAG,CAACZ,GAAG,CAAC,GAAGY,GAAG,CAACZ,GAAG,CAACC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;MAC9DR,QAAQ,CAACS,IAAI,CACX1D,0DAAA;QAAK4D,SAAS,EAAC,cAAc;QAAC3B,GAAG,EAAE,OAAOmB,GAAG;MAAG,GAC9CpD,0DAAA,aAAKoE,GAAG,CAACP,KAAU,CAAC,EACpB7D,0DAAA;QAAM4D,SAAS,EAAC;MAAY,GAAC,GAAC,EAACP,KAAK,GAAG,IAAIA,KAAK,GAAG,GAAG,EAAS,CAC5D,CACP,CAAC;IACH,CAAC,CAAC;IAEF,OACErD,0DAAA;MAAKU,EAAE,EAAC;IAAe,GACrBV,0DAAA;MAAKU,EAAE,EAAC;IAAuB,GAC7BV,0DAAA,eAAMA,0DAAA,CAACE,wDAAgB;MAACQ,EAAE,sBAAqB;MAACC,cAAc;QAAA;QAAA;MAAA;IAAe,CAC7B,CAAO,CAAC,EACxDX,0DAAA;MAAGqE,IAAI,EAAC,GAAG;MAACC,OAAO,EAAGvC,CAAC,IAAK;QAACA,CAAC,CAACC,cAAc,CAAC,CAAC;QAAE,IAAI,CAACjB,KAAK,CAACmB,OAAO,CAAC,CAAC;MAAC;IAAE,GACtElC,0DAAA;MAAG4D,SAAS,EAAC;IAAa,GAAC,OAAQ,CAClC,CACA,CAAC,EACN5D,0DAAA;MAAKU,EAAE,EAAC;IAAyB,GAC/BV,0DAAA;MAAK4D,SAAS,EAAC;IAAU,GACvB5D,0DAAA;MAAK4D,SAAS,EAAC;IAAmB,GAChC5D,0DAAA,iBACEA,0DAAA;MAAK4D,SAAS,EAAC;IAAY,GACzB5D,0DAAA,CAACK,wDAAU;MACTkE,YAAY,EAAE,IAAI,CAACxD,KAAK,CAACyD,MAAM,CAACD,YAAa;MAC7CE,MAAM,EAAElC,QAAQ,IAAI,IAAK;MACzBmC,KAAK,EAAC,WAAW;MACjBC,KAAK,EAAEtC;IAAS,CAAE,CACjB,CACC,CAAC,EACTrC,0DAAA;MAAK4D,SAAS,EAAC;IAAO,GACpB5D,0DAAA;MAAK4D,SAAS,EAAC;IAAkB,GAAEvB,QAAQ,IAAIrC,0DAAA,CAACE,wDAAgB,EAAKM,QAAQ,CAACC,YAAe,CAAO,CACjG,CAAC,EACLiC,GAAG,GACF1C,0DAAA;MAAK4D,SAAS,EAAC;IAAO,GACpB5D,0DAAA,cAAM0C,GAAS,CACZ,CAAC,GACJ,IAAI,EACPD,IAAI,GACHzC,0DAAA;MAAK4D,SAAS,EAAC;IAAO,GACpB5D,0DAAA;MAAO4D,SAAS,EAAC;IAAO,GACtB5D,0DAAA,CAACE,wDAAgB;MAACQ,EAAE,qBAAoB;MAACC,cAAc;QAAA;QAAA;MAAA;IAAc,CACb,CACnD,CAAC,EACRX,0DAAA;MAAK4D,SAAS,EAAC;IAAQ,GAAEnB,IAAU,CAChC,CAAC,GACJ,IAAI,EACPQ,QAAQ,CAAC2B,MAAM,GAAG,CAAC,GAClB5E,0DAAA;MAAK4D,SAAS,EAAC;IAAO,GACpB5D,0DAAA;MAAO4D,SAAS,EAAC;IAAO,GACtB5D,0DAAA,CAACE,wDAAgB;MAACQ,EAAE,uBAAsB;MAACC,cAAc;QAAA;QAAA;MAAA;IAAW,CAC3B,CACpC,CAAC,EACPsC,QACE,CAAC,GACJ,IACD,CACF,CACF,CAAC,EACNjD,0DAAA,CAACI,yDAAW;MACVyE,OAAO,EAAE,IAAK;MACdL,MAAM,EAAE,IAAI,CAACzD,KAAK,CAACyD,MAAO;MAC1BM,KAAK,EAAE,IAAI,CAAC/D,KAAK,CAAC+D,KAAM;MACxBC,aAAa,EAAE,IAAI,CAAChE,KAAK,CAACgE,aAAc;MACxC5C,aAAa,EAAE,IAAI,CAACZ,cAAe;MACnCyD,OAAO,EAAE,IAAI,CAACjE,KAAK,CAACiE;IAAQ,CAAE,CAC7B,CAAC;EAEV;AACF,C","sources":["webpack://tinode-webapp/./src/widgets/the-card-preview.jsx"],"sourcesContent":["import React from 'react';\nimport { defineMessages, FormattedMessage } from 'react-intl';\nimport { parsePhoneNumber } from 'libphonenumber-js/mobile';\n\nimport SendMessage from './send-message.jsx';\nimport LetterTile from './letter-tile.jsx';\n\nimport { TheCard } from 'tinode-sdk';\nimport { importVCard } from '../lib/blob-helpers.js';\n\nconst messages = defineMessages({\n  unknown_name: {\n    id: 'unknown_name',\n    defaultMessage: 'Unknown',\n    description: 'Name to show when the name is missing'\n  }\n});\n\nexport default class TheCardPreview extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      content: props.content.object\n    };\n\n    if (!props.content.object) {\n      importVCard(props.content.file)\n        .then(card => {\n          this.setState({ content: card });\n        });\n    }\n\n    this.handleSendCard = this.handleSendCard.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeyDown);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeyDown);\n  }\n\n  handleKeyDown(e) {\n    e.preventDefault();\n    if (e.key === 'Escape') {\n      this.props.onClose();\n    }\n  }\n\n  handleSendCard() {\n    this.props.onClose();\n    this.props.onSendMessage(this.props.content);\n  }\n\n  render() {\n    const card = this.state.content;\n\n    const fullName = TheCard.getFn(card);\n    const photoUrl = TheCard.getPhotoUrl(card) || null;\n    const note = card?.note;\n    const org = TheCard.getOrg(card);\n\n    // Get communication methods\n    const emails = TheCard.getComm(card, 'email') || [];\n    const phones = TheCard.getComm(card, 'tel') || [];\n    const tinodeIds = TheCard.getComm(card, 'tinode') || [];\n    const urls = TheCard.getComm(card, 'http') || [];\n\n    const contacts = [];\n\n    // Add emails\n    emails.forEach((email, idx) => {\n      const types = Array.isArray(email.des) ? email.des.join(', ') : '';\n      contacts.push(\n        <div className=\"group quoted\" key={`email-${idx}`}>\n          <tt>{email.value}</tt>\n          <span className=\"small gray\"> {types ? `(${types})` : ''}</span>\n        </div>\n      );\n    });\n\n    // Add phones\n    phones.forEach((phone, idx) => {\n      let val = phone.value;\n      try {\n        const number = parsePhoneNumber(phone.value);\n        val = number ? number.formatInternational() : phone.value;\n      } catch (err) {\n        // Use original value if parsing fails\n      }\n      const types = Array.isArray(phone.des) ? phone.des.join(', ') : '';\n      contacts.push(\n        <div className=\"group quoted\" key={`tel-${idx}`}>\n          <tt>{val}</tt>\n          <span className=\"small gray\"> {types ? `(${types})` : ''}</span>\n        </div>\n      );\n    });\n\n    // Add Tinode IDs\n    tinodeIds.forEach((tid, idx) => {\n      const types = Array.isArray(tid.des) ? tid.des.join(', ') : '';\n      contacts.push(\n        <div className=\"group quoted\" key={`tinode-${idx}`}>\n          <tt>{tid.value}</tt>\n          <span className=\"small gray\"> {types ? `(${types})` : ''}</span>\n        </div>\n      );\n    });\n\n    // Add URLs\n    urls.forEach((url, idx) => {\n      const types = Array.isArray(url.des) ? url.des.join(', ') : '';\n      contacts.push(\n        <div className=\"group quoted\" key={`url-${idx}`}>\n          <tt>{url.value}</tt>\n          <span className=\"small gray\"> {types ? `(${types})` : ''}</span>\n        </div>\n      );\n    });\n\n    return (\n      <div id=\"image-preview\">\n        <div id=\"preview-caption-panel\">\n          <span><FormattedMessage id=\"label_contact_card\" defaultMessage=\"Contact Card\"\n            description=\"Label for contact card preview\" /></span>\n          <a href=\"#\" onClick={(e) => {e.preventDefault(); this.props.onClose();}}>\n            <i className=\"m-icon gray\">close</i>\n          </a>\n        </div>\n        <div id=\"image-preview-container\">\n          <div className=\"doc-card\">\n            <div className=\"panel-form-column\">\n              <center>\n                <div className=\"avatar-box\">\n                  <LetterTile\n                    authorizeURL={this.props.tinode.authorizeURL}\n                    avatar={photoUrl || true}\n                    topic=\"usrXXX123\"\n                    title={fullName} />\n                </div>\n              </center>\n              <div className=\"group\">\n                <div className=\"large ellipsized\">{fullName || <FormattedMessage {...messages.unknown_name} />}</div>\n              </div>\n              {org ?\n                <div className=\"group\">\n                  <div>{org}</div>\n                </div>\n                : null}\n              {note ?\n                <div className=\"group\">\n                  <label className=\"small\">\n                    <FormattedMessage id=\"label_description\" defaultMessage=\"Description\"\n                      description=\"Label for description of user or topic\" />\n                  </label>\n                  <div className=\"quoted\">{note}</div>\n                </div>\n                : null}\n              {contacts.length > 0 ?\n                <div className=\"group\">\n                  <label className=\"small\">\n                    <FormattedMessage id=\"label_user_contacts\" defaultMessage=\"Contacts\"\n                      description=\"Label for user contacts\" />\n                  </label>\n                  {contacts}\n                </div>\n                : null}\n            </div>\n          </div>\n        </div>\n        <SendMessage\n          noInput={true}\n          tinode={this.props.tinode}\n          reply={this.props.reply}\n          onCancelReply={this.props.onCancelReply}\n          onSendMessage={this.handleSendCard}\n          onError={this.props.onError} />\n      </div>\n    );\n  }\n}\n"],"names":["React","defineMessages","FormattedMessage","parsePhoneNumber","SendMessage","LetterTile","TheCard","importVCard","messages","unknown_name","id","defaultMessage","TheCardPreview","PureComponent","constructor","props","state","content","object","file","then","card","setState","handleSendCard","bind","handleKeyDown","componentDidMount","document","addEventListener","componentWillUnmount","removeEventListener","e","preventDefault","key","onClose","onSendMessage","render","fullName","getFn","photoUrl","getPhotoUrl","note","org","getOrg","emails","getComm","phones","tinodeIds","urls","contacts","forEach","email","idx","types","Array","isArray","des","join","push","createElement","className","value","phone","val","number","formatInternational","err","tid","url","href","onClick","authorizeURL","tinode","avatar","topic","title","length","noInput","reply","onCancelReply","onError"],"ignoreList":[],"sourceRoot":""}